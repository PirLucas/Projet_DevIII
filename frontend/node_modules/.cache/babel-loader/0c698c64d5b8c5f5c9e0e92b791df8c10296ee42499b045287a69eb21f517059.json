{"ast":null,"code":"import * as EVENTS from '../../common/constant';\nimport { createElement, isNullOrUndefined as isNOU, detach } from '@syncfusion/ej2-base';\n/**\n * PasteCleanup for MsWord content\n *\n * @hidden\n\n */\nvar MsWordPaste = /** @class */function () {\n  function MsWordPaste(parent) {\n    this.olData = ['decimal', 'lower-alpha', 'lower-roman', 'upper-alpha', 'upper-roman', 'lower-greek'];\n    this.ulData = ['disc', 'square', 'circle', 'disc', 'square', 'circle'];\n    this.ignorableNodes = ['A', 'APPLET', 'B', 'BLOCKQUOTE', 'BR', 'BUTTON', 'CENTER', 'CODE', 'COL', 'COLGROUP', 'DD', 'DEL', 'DFN', 'DIR', 'DIV', 'DL', 'DT', 'EM', 'FIELDSET', 'FONT', 'FORM', 'FRAME', 'FRAMESET', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'HR', 'I', 'IMG', 'IFRAME', 'INPUT', 'INS', 'LABEL', 'LI', 'OL', 'OPTION', 'P', 'PARAM', 'PRE', 'Q', 'S', 'SELECT', 'SPAN', 'STRIKE', 'STRONG', 'SUB', 'SUP', 'TABLE', 'TBODY', 'TD', 'TEXTAREA', 'TFOOT', 'TH', 'THEAD', 'TITLE', 'TR', 'TT', 'U', 'UL'];\n    this.blockNode = ['div', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'address', 'blockquote', 'button', 'center', 'dd', 'dir', 'dl', 'dt', 'fieldset', 'frameset', 'hr', 'iframe', 'isindex', 'li', 'map', 'menu', 'noframes', 'noscript', 'object', 'ol', 'pre', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr', 'ul', 'header', 'article', 'nav', 'footer', 'section', 'aside', 'main', 'figure', 'figcaption'];\n    this.borderStyle = ['border-top', 'border-right', 'border-bottom', 'border-left'];\n    this.removableElements = ['o:p', 'style'];\n    this.listContents = [];\n    this.parent = parent;\n    this.addEventListener();\n  }\n  MsWordPaste.prototype.addEventListener = function () {\n    this.parent.observer.on(EVENTS.MS_WORD_CLEANUP_PLUGIN, this.wordCleanup, this);\n  };\n  MsWordPaste.prototype.wordCleanup = function (e) {\n    var wordPasteStyleConfig = !isNOU(e.allowedStylePropertiesArray) ? e.allowedStylePropertiesArray : [];\n    var listNodes = [];\n    var tempHTMLContent = e.args.clipboardData.getData('text/HTML');\n    var rtfData = e.args.clipboardData.getData('text/rtf');\n    var elm = createElement('p');\n    elm.setAttribute('id', 'MSWord-Content');\n    elm.innerHTML = tempHTMLContent;\n    var patern = /class='?Mso|style='[^ ]*\\bmso-/i;\n    var patern2 = /class=\"?Mso|style=\"[^ ]*\\bmso-/i;\n    var patern3 = /(class=\"?Mso|class='?Mso|class=\"?Xl|class='?Xl|class=Xl|style=\"[^\"]*\\bmso-|style='[^']*\\bmso-|w:WordDocument)/gi;\n    var pattern4 = /style='mso-width-source:/i;\n    if (patern.test(tempHTMLContent) || patern2.test(tempHTMLContent) || patern3.test(tempHTMLContent) || pattern4.test(tempHTMLContent)) {\n      this.imageConversion(elm, rtfData);\n      tempHTMLContent = tempHTMLContent.replace(/<img[^>]+>/i, '');\n      this.addListClass(elm);\n      listNodes = this.cleanUp(elm, listNodes);\n      if (!isNOU(listNodes[0]) && listNodes[0].parentElement.tagName !== 'UL' && listNodes[0].parentElement.tagName !== 'OL') {\n        this.listConverter(listNodes);\n      }\n      this.styleCorrection(elm, wordPasteStyleConfig);\n      this.removingComments(elm);\n      this.removeUnwantedElements(elm);\n      this.removeEmptyElements(elm);\n      this.breakLineAddition(elm);\n      this.removeClassName(elm);\n      if (pattern4.test(tempHTMLContent)) {\n        this.addTableBorderClass(elm);\n      }\n      e.callBack(elm.innerHTML);\n    } else {\n      e.callBack(elm.innerHTML);\n    }\n  };\n  MsWordPaste.prototype.addListClass = function (elm) {\n    var allNodes = elm.querySelectorAll('*');\n    for (var index = 0; index < allNodes.length; index++) {\n      if (!isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').replace(/ /g, '').replace('\\n', '').indexOf('mso-list:l') >= 0 && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') === -1 && allNodes[index].tagName.charAt(0) !== 'H') {\n        allNodes[index].classList.add('msolistparagraph');\n      }\n    }\n  };\n  MsWordPaste.prototype.addTableBorderClass = function (elm) {\n    var allTableElm = elm.querySelectorAll('table');\n    var hasTableBorder = false;\n    for (var i = 0; i < allTableElm.length; i++) {\n      for (var j = 0; j < this.borderStyle.length; j++) {\n        if (allTableElm[i].innerHTML.indexOf(this.borderStyle[j]) >= 0) {\n          hasTableBorder = true;\n          break;\n        }\n      }\n      if (hasTableBorder) {\n        allTableElm[i].classList.add('e-rte-table-border');\n        hasTableBorder = false;\n      }\n    }\n  };\n  MsWordPaste.prototype.imageConversion = function (elm, rtfData) {\n    this.checkVShape(elm);\n    var imgElem = elm.querySelectorAll('img');\n    var imgSrc = [];\n    var base64Src = [];\n    var imgName = [];\n    // eslint-disable-next-line\n    var linkRegex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n    if (imgElem.length > 0) {\n      for (var i = 0; i < imgElem.length; i++) {\n        imgSrc.push(imgElem[i].getAttribute('src'));\n        imgName.push(imgElem[i].getAttribute('src').split('/')[imgElem[i].getAttribute('src').split('/').length - 1].split('.')[0]);\n      }\n      var hexValue = this.hexConversion(rtfData);\n      for (var i = 0; i < hexValue.length; i++) {\n        base64Src.push(this.convertToBase64(hexValue[i]));\n      }\n      for (var i = 0; i < imgElem.length; i++) {\n        if (imgSrc[i].match(linkRegex)) {\n          imgElem[i].setAttribute('src', imgSrc[i]);\n        } else {\n          imgElem[i].setAttribute('src', base64Src[i]);\n        }\n        imgElem[i].setAttribute('id', 'msWordImg-' + imgName[i]);\n      }\n    }\n  };\n  MsWordPaste.prototype.checkVShape = function (elm) {\n    var allNodes = elm.querySelectorAll('*');\n    for (var i = 0; i < allNodes.length; i++) {\n      switch (allNodes[i].nodeName) {\n        case 'V:SHAPETYPE':\n          detach(allNodes[i]);\n          break;\n        case 'V:SHAPE':\n          if (allNodes[i].firstElementChild.nodeName === 'V:IMAGEDATA') {\n            var src = allNodes[i].firstElementChild.getAttribute('src');\n            var imgElement = createElement('img');\n            imgElement.setAttribute('src', src);\n            allNodes[i].parentElement.insertBefore(imgElement, allNodes[i]);\n            detach(allNodes[i]);\n          }\n          break;\n      }\n    }\n  };\n  MsWordPaste.prototype.convertToBase64 = function (hexValue) {\n    var byteArr = this.conHexStringToBytes(hexValue.hex);\n    var base64String = this.conBytesToBase64(byteArr);\n    var base64 = hexValue.type ? 'data:' + hexValue.type + ';base64,' + base64String : null;\n    return base64;\n  };\n  MsWordPaste.prototype.conBytesToBase64 = function (byteArr) {\n    var base64Str = '';\n    var base64Char = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n    var byteArrLen = byteArr.length;\n    for (var i = 0; i < byteArrLen; i += 3) {\n      var array3 = byteArr.slice(i, i + 3);\n      var array3length = array3.length;\n      var array4 = [];\n      if (array3length < 3) {\n        for (var j = array3length; j < 3; j++) {\n          array3[j] = 0;\n        }\n      }\n      array4[0] = (array3[0] & 0xFC) >> 2;\n      array4[1] = (array3[0] & 0x03) << 4 | array3[1] >> 4;\n      array4[2] = (array3[1] & 0x0F) << 2 | (array3[2] & 0xC0) >> 6;\n      array4[3] = array3[2] & 0x3F;\n      for (var j = 0; j < 4; j++) {\n        if (j <= array3length) {\n          base64Str += base64Char.charAt(array4[j]);\n        } else {\n          base64Str += '=';\n        }\n      }\n    }\n    return base64Str;\n  };\n  MsWordPaste.prototype.conHexStringToBytes = function (hex) {\n    var byteArr = [];\n    var byteArrLen = hex.length / 2;\n    for (var i = 0; i < byteArrLen; i++) {\n      byteArr.push(parseInt(hex.substr(i * 2, 2), 16));\n    }\n    return byteArr;\n  };\n  MsWordPaste.prototype.hexConversion = function (rtfData) {\n    // eslint-disable-next-line\n    var picHead = /\\{\\\\pict[\\s\\S]+?\\\\bliptag\\-?\\d+(\\\\blipupi\\-?\\d+)?(\\{\\\\\\*\\\\blipuid\\s?[\\da-fA-F]+)?[\\s\\}]*?/;\n    var pic = new RegExp('(?:(' + picHead.source + '))([\\\\da-fA-F\\\\s]+)\\\\}', 'g');\n    var fullImg = rtfData.match(pic);\n    var imgType;\n    var result = [];\n    if (!isNOU(fullImg)) {\n      for (var i = 0; i < fullImg.length; i++) {\n        if (picHead.test(fullImg[i])) {\n          if (fullImg[i].indexOf('\\\\pngblip') !== -1) {\n            imgType = 'image/png';\n          } else if (fullImg[i].indexOf('\\\\jpegblip') !== -1) {\n            imgType = 'image/jpeg';\n          } else {\n            continue;\n          }\n          result.push({\n            hex: imgType ? fullImg[i].replace(picHead, '').replace(/[^\\da-fA-F]/g, '') : null,\n            type: imgType\n          });\n        }\n      }\n    }\n    return result;\n  };\n  MsWordPaste.prototype.removeClassName = function (elm) {\n    var elmWithClass = elm.querySelectorAll('*[class]');\n    for (var i = 0; i < elmWithClass.length; i++) {\n      elmWithClass[i].removeAttribute('class');\n    }\n  };\n  MsWordPaste.prototype.breakLineAddition = function (elm) {\n    var allElements = elm.querySelectorAll('*');\n    for (var i = 0; i < allElements.length; i++) {\n      if (allElements[i].children.length === 0 && allElements[i].innerHTML === '&nbsp;' && allElements[i].innerHTML === '&nbsp;' && !allElements[i].closest('li') && !allElements[i].closest('td')) {\n        var detachableElement = this.findDetachElem(allElements[i]);\n        var brElement = createElement('br');\n        if (!isNOU(detachableElement.parentElement)) {\n          detachableElement.parentElement.insertBefore(brElement, detachableElement);\n          detach(detachableElement);\n        }\n      }\n    }\n  };\n  MsWordPaste.prototype.findDetachElem = function (element) {\n    var removableElement;\n    if (!isNOU(element.parentElement) && element.parentElement.textContent.trim() === '' && element.parentElement.tagName !== 'TD' && isNOU(element.parentElement.querySelector('img'))) {\n      removableElement = this.findDetachElem(element.parentElement);\n    } else {\n      removableElement = element;\n    }\n    return removableElement;\n  };\n  MsWordPaste.prototype.removeUnwantedElements = function (elm) {\n    var innerElement = elm.innerHTML;\n    for (var i = 0; i < this.removableElements.length; i++) {\n      var regExpStartElem = new RegExp('<' + this.removableElements[i] + '>', 'g');\n      var regExpEndElem = new RegExp('</' + this.removableElements[i] + '>', 'g');\n      innerElement = innerElement.replace(regExpStartElem, '');\n      innerElement = innerElement.replace(regExpEndElem, '');\n    }\n    elm.innerHTML = innerElement;\n    elm.querySelectorAll(':empty');\n  };\n  MsWordPaste.prototype.findDetachEmptyElem = function (element) {\n    var removableElement;\n    if (!isNOU(element.parentElement)) {\n      if (element.parentElement.textContent.trim() === '' && element.parentElement.getAttribute('id') !== 'MSWord-Content' && isNOU(element.parentElement.querySelector('img'))) {\n        removableElement = this.findDetachEmptyElem(element.parentElement);\n      } else {\n        removableElement = element;\n      }\n    } else {\n      removableElement = null;\n    }\n    return removableElement;\n  };\n  MsWordPaste.prototype.removeEmptyElements = function (element) {\n    var emptyElements = element.querySelectorAll(':empty');\n    for (var i = 0; i < emptyElements.length; i++) {\n      if (!isNOU(emptyElements[i].closest('td')) && !isNOU(emptyElements[i].closest('td').querySelector('.MsoNormal'))) {\n        emptyElements[i].innerHTML = '-';\n      }\n      if (emptyElements[i].tagName !== 'IMG' && emptyElements[i].tagName !== 'BR' && emptyElements[i].tagName !== 'IFRAME' && emptyElements[i].tagName !== 'TD' && emptyElements[i].tagName !== 'HR') {\n        var detachableElement = this.findDetachEmptyElem(emptyElements[i]);\n        if (!isNOU(detachableElement)) {\n          detach(detachableElement);\n        }\n      }\n    }\n  };\n  MsWordPaste.prototype.styleCorrection = function (elm, wordPasteStyleConfig) {\n    var styleElement = elm.querySelectorAll('style');\n    if (styleElement.length > 0) {\n      var styles = styleElement[0].innerHTML.match(/[\\S ]+\\s+{[\\s\\S]+?}/gi);\n      var styleClassObject_1 = !isNOU(styles) ? this.findStyleObject(styles) : null;\n      var keys = Object.keys(styleClassObject_1);\n      var values = keys.map(function (key) {\n        return styleClassObject_1[key];\n      });\n      values = this.removeUnwantedStyle(values, wordPasteStyleConfig);\n      this.filterStyles(elm, wordPasteStyleConfig);\n      var resultElem = void 0;\n      var fromClass = false;\n      for (var i = 0; i < keys.length; i++) {\n        if (keys[i].split('.')[0] === '') {\n          resultElem = elm.getElementsByClassName(keys[i].split('.')[1]);\n          fromClass = true;\n        } else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') >= 0) {\n          continue;\n        } else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') < 0) {\n          resultElem = elm.getElementsByTagName(keys[i]);\n        } else {\n          resultElem = elm.querySelectorAll(keys[i]);\n        }\n        for (var j = 0; j < resultElem.length; j++) {\n          var styleProperty = resultElem[j].getAttribute('style');\n          if (!isNOU(styleProperty) && styleProperty.trim() !== '') {\n            var valueSplit = values[i].split(';');\n            if (!fromClass) {\n              for (var k = 0; k < valueSplit.length; k++) {\n                if (styleProperty.indexOf(valueSplit[k].split(':')[0]) >= 0) {\n                  valueSplit.splice(k, 1);\n                  k--;\n                }\n              }\n            }\n            values[i] = valueSplit.join(';') + ';';\n            var changedValue = styleProperty + values[i];\n            resultElem[j].setAttribute('style', changedValue);\n          } else {\n            values[i] = values[i].replace(/text-indent:-(.*?)(?=;|$)/gm, '');\n            resultElem[j].setAttribute('style', values[i]);\n          }\n        }\n        fromClass = false;\n      }\n    }\n  };\n  MsWordPaste.prototype.filterStyles = function (elm, wordPasteStyleConfig) {\n    var elmWithStyles = elm.querySelectorAll('*[style]');\n    for (var i = 0; i < elmWithStyles.length; i++) {\n      var elemStyleProperty = elmWithStyles[i].getAttribute('style').split(';');\n      var styleValue = '';\n      for (var j = 0; j < elemStyleProperty.length; j++) {\n        if (wordPasteStyleConfig.indexOf(elemStyleProperty[j].split(':')[0].trim()) >= 0) {\n          styleValue += elemStyleProperty[j] + ';';\n        }\n      }\n      elmWithStyles[i].setAttribute('style', styleValue);\n    }\n  };\n  MsWordPaste.prototype.removeUnwantedStyle = function (values, wordPasteStyleConfig) {\n    for (var i = 0; i < values.length; i++) {\n      var styleValues = values[i].split(';');\n      values[i] = '';\n      for (var j = 0; j < styleValues.length; j++) {\n        if (wordPasteStyleConfig.indexOf(styleValues[j].split(':')[0]) >= 0) {\n          values[i] += styleValues[j] + ';';\n        }\n      }\n    }\n    return values;\n  };\n  MsWordPaste.prototype.findStyleObject = function (styles) {\n    var styleClassObject = {};\n    for (var i = 0; i < styles.length; i++) {\n      var tempStyle = styles[i];\n      var classNameCollection = tempStyle.replace(/([\\S ]+\\s+){[\\s\\S]+?}/gi, '$1');\n      var stylesCollection = tempStyle.replace(/[\\S ]+\\s+{([\\s\\S]+?)}/gi, '$1');\n      classNameCollection = classNameCollection.replace(/^[\\s]|[\\s]$/gm, '');\n      stylesCollection = stylesCollection.replace(/^[\\s]|[\\s]$/gm, '');\n      classNameCollection = classNameCollection.replace(/\\n|\\r|\\n\\r/g, '');\n      stylesCollection = stylesCollection.replace(/\\n|\\r|\\n\\r/g, '');\n      for (var classNames = classNameCollection.split(', '), j = 0; j < classNames.length; j++) {\n        styleClassObject[classNames[j]] = stylesCollection;\n      }\n    }\n    return styleClassObject;\n  };\n  MsWordPaste.prototype.removingComments = function (elm) {\n    var innerElement = elm.innerHTML;\n    innerElement = innerElement.replace(/<!--[\\s\\S]*?-->/g, '');\n    elm.innerHTML = innerElement;\n  };\n  MsWordPaste.prototype.cleanUp = function (node, listNodes) {\n    // eslint-disable-next-line\n    var temp = '';\n    var tempCleaner = [];\n    var prevflagState;\n    var allNodes = node.querySelectorAll('*');\n    for (var index = 0; index < allNodes.length; index++) {\n      if (this.ignorableNodes.indexOf(allNodes[index].nodeName) === -1 || allNodes[index].nodeType === 3 && allNodes[index].textContent.trim() === '') {\n        tempCleaner.push(allNodes[index]);\n        continue;\n      } else if (allNodes[index].className && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && allNodes[index].childElementCount !== 1 && !isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n        if (allNodes[index].className.indexOf('MsoListParagraphCxSpFirst') >= 0 && listNodes.length > 0 && listNodes[listNodes.length - 1] !== null) {\n          listNodes.push(null);\n        }\n        listNodes.push(allNodes[index]);\n      }\n      if (prevflagState && this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1 && !(allNodes[index].className && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0)) {\n        listNodes.push(null);\n      }\n      if (this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1) {\n        if (allNodes[index].className && allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n          prevflagState = true;\n        } else {\n          prevflagState = false;\n        }\n      }\n    }\n    if (listNodes.length && listNodes[listNodes.length - 1] !== null) {\n      listNodes.push(null);\n    }\n    return listNodes;\n  };\n  MsWordPaste.prototype.listConverter = function (listNodes) {\n    var level;\n    var data = [];\n    var collection = [];\n    var content = '';\n    var stNode;\n    var currentListStyle = '';\n    for (var i = 0; i < listNodes.length; i++) {\n      if (listNodes[i] === null) {\n        data.push({\n          content: this.makeConversion(collection),\n          node: listNodes[i - 1]\n        });\n        collection = [];\n        continue;\n      }\n      if (listNodes[i].getAttribute('style') && listNodes[i].getAttribute('style').indexOf('mso-outline-level') !== -1) {\n        listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('mso-outline-level', 'mso-outline'));\n      }\n      content = listNodes[i].getAttribute('style');\n      if (content && content.indexOf('level') !== -1) {\n        // eslint-disable-next-line\n        level = parseInt(content.charAt(content.indexOf('level') + 5), null);\n      } else {\n        level = 1;\n      }\n      this.listContents = [];\n      this.getListContent(listNodes[i]);\n      var type = void 0;\n      var listStyleType = void 0;\n      if (!isNOU(this.listContents[0])) {\n        type = this.listContents[0].trim().length > 1 ? 'ol' : 'ul';\n        listStyleType = this.getlistStyleType(this.listContents[0], type);\n        var tempNode = [];\n        for (var j = 1; j < this.listContents.length; j++) {\n          tempNode.push(this.listContents[j]);\n        }\n        var currentClassName = void 0;\n        if (!isNOU(listNodes[i].className)) {\n          currentClassName = listNodes[i].className;\n        }\n        if (!isNOU(listNodes[i].getAttribute('style'))) {\n          listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('text-align:start;', ''));\n          if (listNodes[i].style.textAlign !== '') {\n            listNodes[i].setAttribute('style', 'text-align:' + listNodes[i].style.textAlign);\n            currentListStyle = listNodes[i].getAttribute('style');\n          }\n        }\n        collection.push({\n          listType: type,\n          content: tempNode,\n          nestedLevel: level,\n          class: currentClassName,\n          listStyle: currentListStyle,\n          listStyleTypeName: listStyleType\n        });\n      }\n    }\n    stNode = listNodes.shift();\n    while (stNode) {\n      var elemColl = [];\n      for (var temp1 = 0; temp1 < data.length; temp1++) {\n        if (data[temp1].node === stNode) {\n          for (var index = 0; index < data[temp1].content.childNodes.length; index++) {\n            elemColl.push(data[temp1].content.childNodes[index]);\n          }\n          for (var index = 0; index < elemColl.length; index++) {\n            stNode.parentElement.insertBefore(elemColl[index], stNode);\n          }\n          break;\n        }\n      }\n      stNode.remove();\n      stNode = listNodes.shift();\n      if (!stNode) {\n        stNode = listNodes.shift();\n      }\n    }\n  };\n  MsWordPaste.prototype.getlistStyleType = function (listContent, type) {\n    var currentListClass;\n    if (type === 'ol') {\n      switch (listContent.split('.')[0]) {\n        case \"A\":\n          currentListClass = \"upper-alpha\";\n          break;\n        case \"a\":\n          currentListClass = \"lower-alpha\";\n          break;\n        case \"I\":\n          currentListClass = \"upper-roman\";\n          break;\n        case \"i\":\n          currentListClass = \"lower-roman\";\n          break;\n        case \"α\":\n          currentListClass = \"lower-greek\";\n          break;\n        default:\n          currentListClass = \"decimal\";\n          break;\n      }\n    } else {\n      switch (listContent.split('.')[0]) {\n        case \"o\":\n          currentListClass = \"circle\";\n          break;\n        case \"§\":\n          currentListClass = \"square\";\n          break;\n        default:\n          currentListClass = \"disc\";\n          break;\n      }\n    }\n    return currentListClass;\n  };\n  MsWordPaste.prototype.makeConversion = function (collection) {\n    var root = createElement('div');\n    var temp;\n    var pLevel = 1;\n    var prevList;\n    var listCount = 0;\n    var elem;\n    for (var index = 0; index < collection.length; index++) {\n      var pElement = createElement('p');\n      pElement.innerHTML = collection[index].content.join(' ');\n      if (collection[index].nestedLevel === 1 && listCount === 0 && collection[index].content) {\n        root.appendChild(temp = createElement(collection[index].listType));\n        prevList = createElement('li');\n        prevList.appendChild(pElement);\n        temp.appendChild(prevList);\n        temp.setAttribute('level', collection[index].nestedLevel.toString());\n        temp.style.listStyleType = collection[index].listStyleTypeName;\n      } else if (collection[index].nestedLevel === pLevel) {\n        if (prevList.parentElement.tagName.toLowerCase() === collection[index].listType) {\n          prevList.parentElement.appendChild(prevList = createElement('li'));\n          prevList.appendChild(pElement);\n        } else {\n          temp = createElement(collection[index].listType);\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n          prevList.parentElement.parentElement.appendChild(temp);\n          prevList = createElement('li');\n          prevList.appendChild(pElement);\n          temp.appendChild(prevList);\n          temp.setAttribute('level', collection[index].nestedLevel.toString());\n        }\n      } else if (collection[index].nestedLevel > pLevel) {\n        if (!isNOU(prevList)) {\n          for (var j = 0; j < collection[index].nestedLevel - pLevel; j++) {\n            prevList.appendChild(temp = createElement(collection[index].listType));\n            prevList = createElement('li');\n            if (j != collection[index].nestedLevel - pLevel - 1 && collection[index].nestedLevel - pLevel > 1) {\n              prevList.style.listStyleType = \"none\";\n            }\n            temp.appendChild(prevList);\n          }\n          prevList.appendChild(pElement);\n          temp.setAttribute('level', collection[index].nestedLevel.toString());\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n        } else {\n          root.appendChild(temp = createElement(collection[index].listType));\n          prevList = createElement('li');\n          prevList.appendChild(pElement);\n          temp.appendChild(prevList);\n          temp.setAttribute('level', collection[index].nestedLevel.toString());\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n        }\n      } else if (collection[index].nestedLevel === 1) {\n        if (root.lastChild.tagName.toLowerCase() === collection[index].listType) {\n          temp = root.lastChild;\n        } else {\n          root.appendChild(temp = createElement(collection[index].listType));\n          temp.style.listStyleType = collection[index].listStyleTypeName;\n        }\n        prevList = createElement('li');\n        prevList.appendChild(pElement);\n        temp.appendChild(prevList);\n        temp.setAttribute('level', collection[index].nestedLevel.toString());\n      } else {\n        elem = prevList;\n        while (elem.parentElement) {\n          elem = elem.parentElement;\n          if (elem.attributes.getNamedItem('level')) {\n            // eslint-disable-next-line\n            if (parseInt(elem.attributes.getNamedItem('level').textContent, null) === collection[index].nestedLevel) {\n              prevList = createElement('li');\n              prevList.appendChild(pElement);\n              elem.appendChild(prevList);\n              break;\n              // eslint-disable-next-line\n            } else if (collection[index].nestedLevel > parseInt(elem.attributes.getNamedItem('level').textContent, null)) {\n              elem.appendChild(temp = createElement(collection[index].listType));\n              prevList = createElement('li');\n              prevList.appendChild(pElement);\n              temp.appendChild(prevList);\n              temp.setAttribute('level', collection[index].nestedLevel.toString());\n              temp.style.listStyleType = collection[index].listStyleTypeName;\n              break;\n            }\n          }\n          continue;\n        }\n      }\n      prevList.setAttribute('class', collection[index].class);\n      var currentStyle = prevList.getAttribute('style');\n      prevList.setAttribute('style', !isNOU(currentStyle) ? currentStyle : '');\n      pLevel = collection[index].nestedLevel;\n      listCount++;\n    }\n    return root;\n  };\n  MsWordPaste.prototype.getListContent = function (elem) {\n    var pushContent = '';\n    var firstChild = elem.firstElementChild;\n    if (firstChild.textContent.trim() === '' && !isNOU(firstChild.firstElementChild) && firstChild.firstElementChild.nodeName === 'IMG') {\n      pushContent = elem.innerHTML.trim();\n      this.listContents.push('');\n      this.listContents.push(pushContent);\n    } else {\n      var styleNodes = ['b', 'em'];\n      if (firstChild.childNodes.length > 0 && (firstChild.querySelectorAll('b').length > 0 || firstChild.querySelectorAll('em').length > 0)) {\n        for (var i = 0; i < firstChild.childNodes.length; i++) {\n          var nodeName = firstChild.childNodes[i].nodeName.toLowerCase();\n          if (firstChild.childNodes[i].textContent.trim().length > 1 && styleNodes.indexOf(nodeName) !== -1) {\n            pushContent = '<' + nodeName + '>' + firstChild.childNodes[i].textContent + '</' + nodeName + '>';\n            this.listContents.push(pushContent);\n          } else if (firstChild.childNodes[i].textContent.trim().length === 1) {\n            this.listContents.push(firstChild.childNodes[i].textContent.trim());\n          }\n        }\n      } else {\n        pushContent = firstChild.textContent.trim();\n        this.listContents.push(pushContent);\n      }\n    }\n    detach(firstChild);\n    this.listContents.push(elem.innerHTML);\n  };\n  return MsWordPaste;\n}();\nexport { MsWordPaste };","map":{"version":3,"names":["EVENTS","createElement","isNullOrUndefined","isNOU","detach","MsWordPaste","parent","olData","ulData","ignorableNodes","blockNode","borderStyle","removableElements","listContents","addEventListener","prototype","observer","on","MS_WORD_CLEANUP_PLUGIN","wordCleanup","e","wordPasteStyleConfig","allowedStylePropertiesArray","listNodes","tempHTMLContent","args","clipboardData","getData","rtfData","elm","setAttribute","innerHTML","patern","patern2","patern3","pattern4","test","imageConversion","replace","addListClass","cleanUp","parentElement","tagName","listConverter","styleCorrection","removingComments","removeUnwantedElements","removeEmptyElements","breakLineAddition","removeClassName","addTableBorderClass","callBack","allNodes","querySelectorAll","index","length","getAttribute","indexOf","className","toLowerCase","charAt","classList","add","allTableElm","hasTableBorder","i","j","checkVShape","imgElem","imgSrc","base64Src","imgName","linkRegex","RegExp","push","split","hexValue","hexConversion","convertToBase64","match","nodeName","firstElementChild","src","imgElement","insertBefore","byteArr","conHexStringToBytes","hex","base64String","conBytesToBase64","base64","type","base64Str","base64Char","byteArrLen","array3","slice","array3length","array4","parseInt","substr","picHead","pic","source","fullImg","imgType","result","elmWithClass","removeAttribute","allElements","children","closest","detachableElement","findDetachElem","brElement","element","removableElement","textContent","trim","querySelector","innerElement","regExpStartElem","regExpEndElem","findDetachEmptyElem","emptyElements","styleElement","styles","styleClassObject_1","findStyleObject","keys","Object","values","map","key","removeUnwantedStyle","filterStyles","resultElem","fromClass","getElementsByClassName","getElementsByTagName","styleProperty","valueSplit","k","splice","join","changedValue","elmWithStyles","elemStyleProperty","styleValue","styleValues","styleClassObject","tempStyle","classNameCollection","stylesCollection","classNames","node","temp","tempCleaner","prevflagState","nodeType","childElementCount","level","data","collection","content","stNode","currentListStyle","makeConversion","getListContent","listStyleType","getlistStyleType","tempNode","currentClassName","style","textAlign","listType","nestedLevel","class","listStyle","listStyleTypeName","shift","elemColl","temp1","childNodes","remove","listContent","currentListClass","root","pLevel","prevList","listCount","elem","pElement","appendChild","toString","lastChild","attributes","getNamedItem","currentStyle","pushContent","firstChild","styleNodes"],"sources":["D:/USPERSO IMPLEMENTATION/Projet_DevIII/frontend/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/ms-word-clean-up.js"],"sourcesContent":["import * as EVENTS from '../../common/constant';\nimport { createElement, isNullOrUndefined as isNOU, detach } from '@syncfusion/ej2-base';\n/**\n * PasteCleanup for MsWord content\n *\n * @hidden\n\n */\nvar MsWordPaste = /** @class */ (function () {\n    function MsWordPaste(parent) {\n        this.olData = [\n            'decimal',\n            'lower-alpha',\n            'lower-roman',\n            'upper-alpha',\n            'upper-roman',\n            'lower-greek'\n        ];\n        this.ulData = [\n            'disc',\n            'square',\n            'circle',\n            'disc',\n            'square',\n            'circle'\n        ];\n        this.ignorableNodes = ['A', 'APPLET', 'B', 'BLOCKQUOTE', 'BR',\n            'BUTTON', 'CENTER', 'CODE', 'COL', 'COLGROUP', 'DD', 'DEL', 'DFN', 'DIR', 'DIV',\n            'DL', 'DT', 'EM', 'FIELDSET', 'FONT', 'FORM', 'FRAME', 'FRAMESET', 'H1', 'H2',\n            'H3', 'H4', 'H5', 'H6', 'HR', 'I', 'IMG', 'IFRAME', 'INPUT', 'INS', 'LABEL',\n            'LI', 'OL', 'OPTION', 'P', 'PARAM', 'PRE', 'Q', 'S', 'SELECT', 'SPAN', 'STRIKE',\n            'STRONG', 'SUB', 'SUP', 'TABLE', 'TBODY', 'TD', 'TEXTAREA', 'TFOOT', 'TH',\n            'THEAD', 'TITLE', 'TR', 'TT', 'U', 'UL'];\n        this.blockNode = ['div', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6',\n            'address', 'blockquote', 'button', 'center', 'dd', 'dir', 'dl', 'dt', 'fieldset',\n            'frameset', 'hr', 'iframe', 'isindex', 'li', 'map', 'menu', 'noframes', 'noscript',\n            'object', 'ol', 'pre', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr', 'ul',\n            'header', 'article', 'nav', 'footer', 'section', 'aside', 'main', 'figure', 'figcaption'];\n        this.borderStyle = ['border-top', 'border-right', 'border-bottom', 'border-left'];\n        this.removableElements = ['o:p', 'style'];\n        this.listContents = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    MsWordPaste.prototype.addEventListener = function () {\n        this.parent.observer.on(EVENTS.MS_WORD_CLEANUP_PLUGIN, this.wordCleanup, this);\n    };\n    MsWordPaste.prototype.wordCleanup = function (e) {\n        var wordPasteStyleConfig = !isNOU(e.allowedStylePropertiesArray) ? e.allowedStylePropertiesArray : [];\n        var listNodes = [];\n        var tempHTMLContent = e.args.clipboardData.getData('text/HTML');\n        var rtfData = e.args.clipboardData.getData('text/rtf');\n        var elm = createElement('p');\n        elm.setAttribute('id', 'MSWord-Content');\n        elm.innerHTML = tempHTMLContent;\n        var patern = /class='?Mso|style='[^ ]*\\bmso-/i;\n        var patern2 = /class=\"?Mso|style=\"[^ ]*\\bmso-/i;\n        var patern3 = /(class=\"?Mso|class='?Mso|class=\"?Xl|class='?Xl|class=Xl|style=\"[^\"]*\\bmso-|style='[^']*\\bmso-|w:WordDocument)/gi;\n        var pattern4 = /style='mso-width-source:/i;\n        if (patern.test(tempHTMLContent) || patern2.test(tempHTMLContent) || patern3.test(tempHTMLContent) ||\n            pattern4.test(tempHTMLContent)) {\n            this.imageConversion(elm, rtfData);\n            tempHTMLContent = tempHTMLContent.replace(/<img[^>]+>/i, '');\n            this.addListClass(elm);\n            listNodes = this.cleanUp(elm, listNodes);\n            if (!isNOU(listNodes[0]) && listNodes[0].parentElement.tagName !== 'UL' &&\n                listNodes[0].parentElement.tagName !== 'OL') {\n                this.listConverter(listNodes);\n            }\n            this.styleCorrection(elm, wordPasteStyleConfig);\n            this.removingComments(elm);\n            this.removeUnwantedElements(elm);\n            this.removeEmptyElements(elm);\n            this.breakLineAddition(elm);\n            this.removeClassName(elm);\n            if (pattern4.test(tempHTMLContent)) {\n                this.addTableBorderClass(elm);\n            }\n            e.callBack(elm.innerHTML);\n        }\n        else {\n            e.callBack(elm.innerHTML);\n        }\n    };\n    MsWordPaste.prototype.addListClass = function (elm) {\n        var allNodes = elm.querySelectorAll('*');\n        for (var index = 0; index < allNodes.length; index++) {\n            if (!isNOU(allNodes[index].getAttribute('style')) && allNodes[index].getAttribute('style').replace(/ /g, '').replace('\\n', '').indexOf('mso-list:l') >= 0 &&\n                allNodes[index].className.toLowerCase().indexOf('msolistparagraph') === -1 && allNodes[index].tagName.charAt(0) !== 'H') {\n                allNodes[index].classList.add('msolistparagraph');\n            }\n        }\n    };\n    MsWordPaste.prototype.addTableBorderClass = function (elm) {\n        var allTableElm = elm.querySelectorAll('table');\n        var hasTableBorder = false;\n        for (var i = 0; i < allTableElm.length; i++) {\n            for (var j = 0; j < this.borderStyle.length; j++) {\n                if (allTableElm[i].innerHTML.indexOf(this.borderStyle[j]) >= 0) {\n                    hasTableBorder = true;\n                    break;\n                }\n            }\n            if (hasTableBorder) {\n                allTableElm[i].classList.add('e-rte-table-border');\n                hasTableBorder = false;\n            }\n        }\n    };\n    MsWordPaste.prototype.imageConversion = function (elm, rtfData) {\n        this.checkVShape(elm);\n        var imgElem = elm.querySelectorAll('img');\n        var imgSrc = [];\n        var base64Src = [];\n        var imgName = [];\n        // eslint-disable-next-line\n        var linkRegex = new RegExp(/([^\\S]|^)(((https?\\:\\/\\/)|(www\\.))(\\S+))/gi);\n        if (imgElem.length > 0) {\n            for (var i = 0; i < imgElem.length; i++) {\n                imgSrc.push(imgElem[i].getAttribute('src'));\n                imgName.push(imgElem[i].getAttribute('src').split('/')[imgElem[i].getAttribute('src').split('/').length - 1].split('.')[0]);\n            }\n            var hexValue = this.hexConversion(rtfData);\n            for (var i = 0; i < hexValue.length; i++) {\n                base64Src.push(this.convertToBase64(hexValue[i]));\n            }\n            for (var i = 0; i < imgElem.length; i++) {\n                if (imgSrc[i].match(linkRegex)) {\n                    imgElem[i].setAttribute('src', imgSrc[i]);\n                }\n                else {\n                    imgElem[i].setAttribute('src', base64Src[i]);\n                }\n                imgElem[i].setAttribute('id', 'msWordImg-' + imgName[i]);\n            }\n        }\n    };\n    MsWordPaste.prototype.checkVShape = function (elm) {\n        var allNodes = elm.querySelectorAll('*');\n        for (var i = 0; i < allNodes.length; i++) {\n            switch (allNodes[i].nodeName) {\n                case 'V:SHAPETYPE':\n                    detach(allNodes[i]);\n                    break;\n                case 'V:SHAPE':\n                    if (allNodes[i].firstElementChild.nodeName === 'V:IMAGEDATA') {\n                        var src = allNodes[i].firstElementChild.getAttribute('src');\n                        var imgElement = createElement('img');\n                        imgElement.setAttribute('src', src);\n                        allNodes[i].parentElement.insertBefore(imgElement, allNodes[i]);\n                        detach(allNodes[i]);\n                    }\n                    break;\n            }\n        }\n    };\n    MsWordPaste.prototype.convertToBase64 = function (hexValue) {\n        var byteArr = this.conHexStringToBytes(hexValue.hex);\n        var base64String = this.conBytesToBase64(byteArr);\n        var base64 = hexValue.type ? 'data:' + hexValue.type + ';base64,' + base64String : null;\n        return base64;\n    };\n    MsWordPaste.prototype.conBytesToBase64 = function (byteArr) {\n        var base64Str = '';\n        var base64Char = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n        var byteArrLen = byteArr.length;\n        for (var i = 0; i < byteArrLen; i += 3) {\n            var array3 = byteArr.slice(i, i + 3);\n            var array3length = array3.length;\n            var array4 = [];\n            if (array3length < 3) {\n                for (var j = array3length; j < 3; j++) {\n                    array3[j] = 0;\n                }\n            }\n            array4[0] = (array3[0] & 0xFC) >> 2;\n            array4[1] = ((array3[0] & 0x03) << 4) | (array3[1] >> 4);\n            array4[2] = ((array3[1] & 0x0F) << 2) | ((array3[2] & 0xC0) >> 6);\n            array4[3] = array3[2] & 0x3F;\n            for (var j = 0; j < 4; j++) {\n                if (j <= array3length) {\n                    base64Str += base64Char.charAt(array4[j]);\n                }\n                else {\n                    base64Str += '=';\n                }\n            }\n        }\n        return base64Str;\n    };\n    MsWordPaste.prototype.conHexStringToBytes = function (hex) {\n        var byteArr = [];\n        var byteArrLen = hex.length / 2;\n        for (var i = 0; i < byteArrLen; i++) {\n            byteArr.push(parseInt(hex.substr(i * 2, 2), 16));\n        }\n        return byteArr;\n    };\n    MsWordPaste.prototype.hexConversion = function (rtfData) {\n        // eslint-disable-next-line\n        var picHead = /\\{\\\\pict[\\s\\S]+?\\\\bliptag\\-?\\d+(\\\\blipupi\\-?\\d+)?(\\{\\\\\\*\\\\blipuid\\s?[\\da-fA-F]+)?[\\s\\}]*?/;\n        var pic = new RegExp('(?:(' + picHead.source + '))([\\\\da-fA-F\\\\s]+)\\\\}', 'g');\n        var fullImg = rtfData.match(pic);\n        var imgType;\n        var result = [];\n        if (!isNOU(fullImg)) {\n            for (var i = 0; i < fullImg.length; i++) {\n                if (picHead.test(fullImg[i])) {\n                    if (fullImg[i].indexOf('\\\\pngblip') !== -1) {\n                        imgType = 'image/png';\n                    }\n                    else if (fullImg[i].indexOf('\\\\jpegblip') !== -1) {\n                        imgType = 'image/jpeg';\n                    }\n                    else {\n                        continue;\n                    }\n                    result.push({\n                        hex: imgType ? fullImg[i].replace(picHead, '').replace(/[^\\da-fA-F]/g, '') : null,\n                        type: imgType\n                    });\n                }\n            }\n        }\n        return result;\n    };\n    MsWordPaste.prototype.removeClassName = function (elm) {\n        var elmWithClass = elm.querySelectorAll('*[class]');\n        for (var i = 0; i < elmWithClass.length; i++) {\n            elmWithClass[i].removeAttribute('class');\n        }\n    };\n    MsWordPaste.prototype.breakLineAddition = function (elm) {\n        var allElements = elm.querySelectorAll('*');\n        for (var i = 0; i < allElements.length; i++) {\n            if (allElements[i].children.length === 0 && allElements[i].innerHTML === '&nbsp;' &&\n                (allElements[i].innerHTML === '&nbsp;' && !allElements[i].closest('li')) &&\n                !allElements[i].closest('td')) {\n                var detachableElement = this.findDetachElem(allElements[i]);\n                var brElement = createElement('br');\n                if (!isNOU(detachableElement.parentElement)) {\n                    detachableElement.parentElement.insertBefore(brElement, detachableElement);\n                    detach(detachableElement);\n                }\n            }\n        }\n    };\n    MsWordPaste.prototype.findDetachElem = function (element) {\n        var removableElement;\n        if (!isNOU(element.parentElement) &&\n            element.parentElement.textContent.trim() === '' && element.parentElement.tagName !== 'TD' &&\n            isNOU(element.parentElement.querySelector('img'))) {\n            removableElement = this.findDetachElem(element.parentElement);\n        }\n        else {\n            removableElement = element;\n        }\n        return removableElement;\n    };\n    MsWordPaste.prototype.removeUnwantedElements = function (elm) {\n        var innerElement = elm.innerHTML;\n        for (var i = 0; i < this.removableElements.length; i++) {\n            var regExpStartElem = new RegExp('<' + this.removableElements[i] + '>', 'g');\n            var regExpEndElem = new RegExp('</' + this.removableElements[i] + '>', 'g');\n            innerElement = innerElement.replace(regExpStartElem, '');\n            innerElement = innerElement.replace(regExpEndElem, '');\n        }\n        elm.innerHTML = innerElement;\n        elm.querySelectorAll(':empty');\n    };\n    MsWordPaste.prototype.findDetachEmptyElem = function (element) {\n        var removableElement;\n        if (!isNOU(element.parentElement)) {\n            if (element.parentElement.textContent.trim() === '' &&\n                element.parentElement.getAttribute('id') !== 'MSWord-Content' &&\n                isNOU(element.parentElement.querySelector('img'))) {\n                removableElement = this.findDetachEmptyElem(element.parentElement);\n            }\n            else {\n                removableElement = element;\n            }\n        }\n        else {\n            removableElement = null;\n        }\n        return removableElement;\n    };\n    MsWordPaste.prototype.removeEmptyElements = function (element) {\n        var emptyElements = element.querySelectorAll(':empty');\n        for (var i = 0; i < emptyElements.length; i++) {\n            if (!isNOU(emptyElements[i].closest('td')) &&\n                !isNOU(emptyElements[i].closest('td').querySelector('.MsoNormal'))) {\n                emptyElements[i].innerHTML = '-';\n            }\n            if (emptyElements[i].tagName !== 'IMG' && emptyElements[i].tagName !== 'BR' &&\n                emptyElements[i].tagName !== 'IFRAME' && emptyElements[i].tagName !== 'TD' &&\n                emptyElements[i].tagName !== 'HR') {\n                var detachableElement = this.findDetachEmptyElem(emptyElements[i]);\n                if (!isNOU(detachableElement)) {\n                    detach(detachableElement);\n                }\n            }\n        }\n    };\n    MsWordPaste.prototype.styleCorrection = function (elm, wordPasteStyleConfig) {\n        var styleElement = elm.querySelectorAll('style');\n        if (styleElement.length > 0) {\n            var styles = styleElement[0].innerHTML.match(/[\\S ]+\\s+{[\\s\\S]+?}/gi);\n            var styleClassObject_1 = !isNOU(styles) ? this.findStyleObject(styles) : null;\n            var keys = Object.keys(styleClassObject_1);\n            var values = keys.map(function (key) {\n                return styleClassObject_1[key];\n            });\n            values = this.removeUnwantedStyle(values, wordPasteStyleConfig);\n            this.filterStyles(elm, wordPasteStyleConfig);\n            var resultElem = void 0;\n            var fromClass = false;\n            for (var i = 0; i < keys.length; i++) {\n                if (keys[i].split('.')[0] === '') {\n                    resultElem = elm.getElementsByClassName(keys[i].split('.')[1]);\n                    fromClass = true;\n                }\n                else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') >= 0) {\n                    continue;\n                }\n                else if (keys[i].split('.').length === 1 && keys[i].split('.')[0].indexOf('@') < 0) {\n                    resultElem = elm.getElementsByTagName(keys[i]);\n                }\n                else {\n                    resultElem = elm.querySelectorAll(keys[i]);\n                }\n                for (var j = 0; j < resultElem.length; j++) {\n                    var styleProperty = resultElem[j].getAttribute('style');\n                    if (!isNOU(styleProperty) && styleProperty.trim() !== '') {\n                        var valueSplit = values[i].split(';');\n                        if (!fromClass) {\n                            for (var k = 0; k < valueSplit.length; k++) {\n                                if (styleProperty.indexOf(valueSplit[k].split(':')[0]) >= 0) {\n                                    valueSplit.splice(k, 1);\n                                    k--;\n                                }\n                            }\n                        }\n                        values[i] = valueSplit.join(';') + ';';\n                        var changedValue = styleProperty + values[i];\n                        resultElem[j].setAttribute('style', changedValue);\n                    }\n                    else {\n                        values[i] = values[i].replace(/text-indent:-(.*?)(?=;|$)/gm, '');\n                        resultElem[j].setAttribute('style', values[i]);\n                    }\n                }\n                fromClass = false;\n            }\n        }\n    };\n    MsWordPaste.prototype.filterStyles = function (elm, wordPasteStyleConfig) {\n        var elmWithStyles = elm.querySelectorAll('*[style]');\n        for (var i = 0; i < elmWithStyles.length; i++) {\n            var elemStyleProperty = elmWithStyles[i].getAttribute('style').split(';');\n            var styleValue = '';\n            for (var j = 0; j < elemStyleProperty.length; j++) {\n                if (wordPasteStyleConfig.indexOf(elemStyleProperty[j].split(':')[0].trim()) >= 0) {\n                    styleValue += elemStyleProperty[j] + ';';\n                }\n            }\n            elmWithStyles[i].setAttribute('style', styleValue);\n        }\n    };\n    MsWordPaste.prototype.removeUnwantedStyle = function (values, wordPasteStyleConfig) {\n        for (var i = 0; i < values.length; i++) {\n            var styleValues = values[i].split(';');\n            values[i] = '';\n            for (var j = 0; j < styleValues.length; j++) {\n                if (wordPasteStyleConfig.indexOf(styleValues[j].split(':')[0]) >= 0) {\n                    values[i] += styleValues[j] + ';';\n                }\n            }\n        }\n        return values;\n    };\n    MsWordPaste.prototype.findStyleObject = function (styles) {\n        var styleClassObject = {};\n        for (var i = 0; i < styles.length; i++) {\n            var tempStyle = styles[i];\n            var classNameCollection = tempStyle.replace(/([\\S ]+\\s+){[\\s\\S]+?}/gi, '$1');\n            var stylesCollection = tempStyle.replace(/[\\S ]+\\s+{([\\s\\S]+?)}/gi, '$1');\n            classNameCollection = classNameCollection.replace(/^[\\s]|[\\s]$/gm, '');\n            stylesCollection = stylesCollection.replace(/^[\\s]|[\\s]$/gm, '');\n            classNameCollection = classNameCollection.replace(/\\n|\\r|\\n\\r/g, '');\n            stylesCollection = stylesCollection.replace(/\\n|\\r|\\n\\r/g, '');\n            for (var classNames = classNameCollection.split(', '), j = 0; j < classNames.length; j++) {\n                styleClassObject[classNames[j]] = stylesCollection;\n            }\n        }\n        return styleClassObject;\n    };\n    MsWordPaste.prototype.removingComments = function (elm) {\n        var innerElement = elm.innerHTML;\n        innerElement = innerElement.replace(/<!--[\\s\\S]*?-->/g, '');\n        elm.innerHTML = innerElement;\n    };\n    MsWordPaste.prototype.cleanUp = function (node, listNodes) {\n        // eslint-disable-next-line\n        var temp = '';\n        var tempCleaner = [];\n        var prevflagState;\n        var allNodes = node.querySelectorAll('*');\n        for (var index = 0; index < allNodes.length; index++) {\n            if (this.ignorableNodes.indexOf(allNodes[index].nodeName) === -1 ||\n                (allNodes[index].nodeType === 3 && allNodes[index].textContent.trim() === '')) {\n                tempCleaner.push(allNodes[index]);\n                continue;\n            }\n            else if (allNodes[index].className &&\n                allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 &&\n                allNodes[index].childElementCount !== 1 && !isNOU(allNodes[index].getAttribute('style')) &&\n                allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n                if (allNodes[index].className.indexOf('MsoListParagraphCxSpFirst') >= 0 && listNodes.length > 0 &&\n                    listNodes[listNodes.length - 1] !== null) {\n                    listNodes.push(null);\n                }\n                listNodes.push(allNodes[index]);\n            }\n            if (prevflagState && (this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1) &&\n                !(allNodes[index].className &&\n                    allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) &&\n                    allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0)) {\n                listNodes.push(null);\n            }\n            if (this.blockNode.indexOf(allNodes[index].nodeName.toLowerCase()) !== -1) {\n                if (allNodes[index].className &&\n                    allNodes[index].className.toLowerCase().indexOf('msolistparagraph') !== -1 && !isNOU(allNodes[index].getAttribute('style')) &&\n                    allNodes[index].getAttribute('style').indexOf('mso-list:') >= 0) {\n                    prevflagState = true;\n                }\n                else {\n                    prevflagState = false;\n                }\n            }\n        }\n        if (listNodes.length && (listNodes[listNodes.length - 1] !== null)) {\n            listNodes.push(null);\n        }\n        return listNodes;\n    };\n    MsWordPaste.prototype.listConverter = function (listNodes) {\n        var level;\n        var data = [];\n        var collection = [];\n        var content = '';\n        var stNode;\n        var currentListStyle = '';\n        for (var i = 0; i < listNodes.length; i++) {\n            if (listNodes[i] === null) {\n                data.push({ content: this.makeConversion(collection), node: listNodes[i - 1] });\n                collection = [];\n                continue;\n            }\n            if (listNodes[i].getAttribute('style') && listNodes[i].getAttribute('style').indexOf('mso-outline-level') !== -1) {\n                listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('mso-outline-level', 'mso-outline'));\n            }\n            content = listNodes[i].getAttribute('style');\n            if (content && content.indexOf('level') !== -1) {\n                // eslint-disable-next-line\n                level = parseInt(content.charAt(content.indexOf('level') + 5), null);\n            }\n            else {\n                level = 1;\n            }\n            this.listContents = [];\n            this.getListContent(listNodes[i]);\n            var type = void 0;\n            var listStyleType = void 0;\n            if (!isNOU(this.listContents[0])) {\n                type = this.listContents[0].trim().length > 1 ? 'ol' : 'ul';\n                listStyleType = this.getlistStyleType(this.listContents[0], type);\n                var tempNode = [];\n                for (var j = 1; j < this.listContents.length; j++) {\n                    tempNode.push(this.listContents[j]);\n                }\n                var currentClassName = void 0;\n                if (!isNOU(listNodes[i].className)) {\n                    currentClassName = listNodes[i].className;\n                }\n                if (!isNOU(listNodes[i].getAttribute('style'))) {\n                    listNodes[i].setAttribute('style', listNodes[i].getAttribute('style').replace('text-align:start;', ''));\n                    if (listNodes[i].style.textAlign !== '') {\n                        listNodes[i].setAttribute('style', 'text-align:' + listNodes[i].style.textAlign);\n                        currentListStyle = listNodes[i].getAttribute('style');\n                    }\n                }\n                collection.push({ listType: type, content: tempNode, nestedLevel: level, class: currentClassName,\n                    listStyle: currentListStyle, listStyleTypeName: listStyleType });\n            }\n        }\n        stNode = listNodes.shift();\n        while (stNode) {\n            var elemColl = [];\n            for (var temp1 = 0; temp1 < data.length; temp1++) {\n                if (data[temp1].node === stNode) {\n                    for (var index = 0; index < data[temp1].content.childNodes.length; index++) {\n                        elemColl.push(data[temp1].content.childNodes[index]);\n                    }\n                    for (var index = 0; index < elemColl.length; index++) {\n                        stNode.parentElement.insertBefore(elemColl[index], stNode);\n                    }\n                    break;\n                }\n            }\n            stNode.remove();\n            stNode = listNodes.shift();\n            if (!stNode) {\n                stNode = listNodes.shift();\n            }\n        }\n    };\n    MsWordPaste.prototype.getlistStyleType = function (listContent, type) {\n        var currentListClass;\n        if (type === 'ol') {\n            switch (listContent.split('.')[0]) {\n                case \"A\":\n                    currentListClass = \"upper-alpha\";\n                    break;\n                case \"a\":\n                    currentListClass = \"lower-alpha\";\n                    break;\n                case \"I\":\n                    currentListClass = \"upper-roman\";\n                    break;\n                case \"i\":\n                    currentListClass = \"lower-roman\";\n                    break;\n                case \"α\":\n                    currentListClass = \"lower-greek\";\n                    break;\n                default:\n                    currentListClass = \"decimal\";\n                    break;\n            }\n        }\n        else {\n            switch (listContent.split('.')[0]) {\n                case \"o\":\n                    currentListClass = \"circle\";\n                    break;\n                case \"§\":\n                    currentListClass = \"square\";\n                    break;\n                default:\n                    currentListClass = \"disc\";\n                    break;\n            }\n        }\n        return currentListClass;\n    };\n    MsWordPaste.prototype.makeConversion = function (collection) {\n        var root = createElement('div');\n        var temp;\n        var pLevel = 1;\n        var prevList;\n        var listCount = 0;\n        var elem;\n        for (var index = 0; index < collection.length; index++) {\n            var pElement = createElement('p');\n            pElement.innerHTML = collection[index].content.join(' ');\n            if ((collection[index].nestedLevel === 1) && listCount === 0 && collection[index].content) {\n                root.appendChild(temp = createElement(collection[index].listType));\n                prevList = createElement('li');\n                prevList.appendChild(pElement);\n                temp.appendChild(prevList);\n                temp.setAttribute('level', collection[index].nestedLevel.toString());\n                temp.style.listStyleType = collection[index].listStyleTypeName;\n            }\n            else if (collection[index].nestedLevel === pLevel) {\n                if (prevList.parentElement.tagName.toLowerCase() === collection[index].listType) {\n                    prevList.parentElement.appendChild(prevList = createElement('li'));\n                    prevList.appendChild(pElement);\n                }\n                else {\n                    temp = createElement(collection[index].listType);\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                    prevList.parentElement.parentElement.appendChild(temp);\n                    prevList = createElement('li');\n                    prevList.appendChild(pElement);\n                    temp.appendChild(prevList);\n                    temp.setAttribute('level', collection[index].nestedLevel.toString());\n                }\n            }\n            else if (collection[index].nestedLevel > pLevel) {\n                if (!isNOU(prevList)) {\n                    for (var j = 0; j < collection[index].nestedLevel - pLevel; j++) {\n                        prevList.appendChild(temp = createElement(collection[index].listType));\n                        prevList = createElement('li');\n                        if (j != collection[index].nestedLevel - pLevel - 1 && collection[index].nestedLevel - pLevel > 1) {\n                            prevList.style.listStyleType = \"none\";\n                        }\n                        temp.appendChild(prevList);\n                    }\n                    prevList.appendChild(pElement);\n                    temp.setAttribute('level', collection[index].nestedLevel.toString());\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                }\n                else {\n                    root.appendChild(temp = createElement(collection[index].listType));\n                    prevList = createElement('li');\n                    prevList.appendChild(pElement);\n                    temp.appendChild(prevList);\n                    temp.setAttribute('level', collection[index].nestedLevel.toString());\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                }\n            }\n            else if (collection[index].nestedLevel === 1) {\n                if (root.lastChild.tagName.toLowerCase() === collection[index].listType) {\n                    temp = root.lastChild;\n                }\n                else {\n                    root.appendChild(temp = createElement(collection[index].listType));\n                    temp.style.listStyleType = collection[index].listStyleTypeName;\n                }\n                prevList = createElement('li');\n                prevList.appendChild(pElement);\n                temp.appendChild(prevList);\n                temp.setAttribute('level', collection[index].nestedLevel.toString());\n            }\n            else {\n                elem = prevList;\n                while (elem.parentElement) {\n                    elem = elem.parentElement;\n                    if (elem.attributes.getNamedItem('level')) {\n                        // eslint-disable-next-line\n                        if (parseInt(elem.attributes.getNamedItem('level').textContent, null) === collection[index].nestedLevel) {\n                            prevList = createElement('li');\n                            prevList.appendChild(pElement);\n                            elem.appendChild(prevList);\n                            break;\n                            // eslint-disable-next-line\n                        }\n                        else if (collection[index].nestedLevel > parseInt(elem.attributes.getNamedItem('level').textContent, null)) {\n                            elem.appendChild(temp = createElement(collection[index].listType));\n                            prevList = createElement('li');\n                            prevList.appendChild(pElement);\n                            temp.appendChild(prevList);\n                            temp.setAttribute('level', collection[index].nestedLevel.toString());\n                            temp.style.listStyleType = collection[index].listStyleTypeName;\n                            break;\n                        }\n                    }\n                    continue;\n                }\n            }\n            prevList.setAttribute('class', collection[index].class);\n            var currentStyle = prevList.getAttribute('style');\n            prevList.setAttribute('style', (!isNOU(currentStyle) ? currentStyle : ''));\n            pLevel = collection[index].nestedLevel;\n            listCount++;\n        }\n        return root;\n    };\n    MsWordPaste.prototype.getListContent = function (elem) {\n        var pushContent = '';\n        var firstChild = elem.firstElementChild;\n        if (firstChild.textContent.trim() === '' && !isNOU(firstChild.firstElementChild) &&\n            firstChild.firstElementChild.nodeName === 'IMG') {\n            pushContent = elem.innerHTML.trim();\n            this.listContents.push('');\n            this.listContents.push(pushContent);\n        }\n        else {\n            var styleNodes = ['b', 'em'];\n            if (firstChild.childNodes.length > 0 && (firstChild.querySelectorAll('b').length > 0\n                || firstChild.querySelectorAll('em').length > 0)) {\n                for (var i = 0; i < firstChild.childNodes.length; i++) {\n                    var nodeName = firstChild.childNodes[i].nodeName.toLowerCase();\n                    if (firstChild.childNodes[i].textContent.trim().length > 1 && styleNodes.indexOf(nodeName) !== -1) {\n                        pushContent = '<' + nodeName + '>' + firstChild.childNodes[i].textContent + '</' + nodeName + '>';\n                        this.listContents.push(pushContent);\n                    }\n                    else if (firstChild.childNodes[i].textContent.trim().length === 1) {\n                        this.listContents.push(firstChild.childNodes[i].textContent.trim());\n                    }\n                }\n            }\n            else {\n                pushContent = firstChild.textContent.trim();\n                this.listContents.push(pushContent);\n            }\n        }\n        detach(firstChild);\n        this.listContents.push(elem.innerHTML);\n    };\n    return MsWordPaste;\n}());\nexport { MsWordPaste };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}