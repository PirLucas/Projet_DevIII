{"ast":null,"code":"import * as CONSTANT from './../base/constant';\nimport { createElement, detach, prepend, append, attributes } from '@syncfusion/ej2-base';\nimport { markerClassName } from './dom-node';\nimport * as EVENTS from './../../common/constant';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isIDevice, setEditFrameFocus } from '../../common/util';\nimport { isNullOrUndefined, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Lists internal component\n *\n * @hidden\n\n */\nvar Lists = /** @class */function () {\n  /**\n   * Constructor for creating the Lists plugin\n   *\n   * @param {EditorManager} parent - specifies the parent element\n   * @hidden\n    */\n  function Lists(parent) {\n    this.parent = parent;\n    this.domNode = this.parent.domNode;\n    this.addEventListener();\n  }\n  Lists.prototype.addEventListener = function () {\n    this.parent.observer.on(EVENTS.LIST_TYPE, this.applyListsHandler, this);\n    this.parent.observer.on(EVENTS.KEY_DOWN_HANDLER, this.keyDownHandler, this);\n    this.parent.observer.on(EVENTS.SPACE_ACTION, this.spaceKeyAction, this);\n  };\n  Lists.prototype.testList = function (elem) {\n    var olListRegex = [/^[\\d]+[.]+$/, /^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi, /^[a-zA-Z][.]+$/];\n    var elementStart = !isNullOrUndefined(elem) ? elem.innerText.trim().split('.')[0] + '.' : null;\n    if (!isNullOrUndefined(elementStart)) {\n      for (var i = 0; i < olListRegex.length; i++) {\n        if (olListRegex[i].test(elementStart)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  Lists.prototype.testCurrentList = function (range) {\n    var olListStartRegex = [/^[1]+[.]+$/, /^[i]+[.]+$/, /^[a]+[.]+$/];\n    if (!isNullOrUndefined(range.startContainer.textContent.slice(0, range.startOffset))) {\n      var currentContent = range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim();\n      for (var i = 0; i < olListStartRegex.length; i++) {\n        if (olListStartRegex[i].test(currentContent) && currentContent.length === 2) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n  Lists.prototype.spaceList = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n    var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n    // eslint-disable-next-line\n    var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n    var preElement = startNode.previousElementSibling;\n    var nextElement = startNode.nextElementSibling;\n    var preElemULStart = !isNullOrUndefined(preElement) ? preElement.innerText.trim().substring(0, 1) : null;\n    var nextElemULStart = !isNullOrUndefined(nextElement) ? nextElement.innerText.trim().substring(0, 1) : null;\n    var startElementOLTest = this.testCurrentList(range);\n    var preElementOLTest = this.testList(preElement);\n    var nextElementOLTest = this.testList(nextElement);\n    if (!preElementOLTest && !nextElementOLTest && preElemULStart !== '*' && nextElemULStart !== '*') {\n      if (startElementOLTest) {\n        range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n        this.applyListsHandler({\n          subCommand: 'OL',\n          callBack: e.callBack\n        });\n        e.event.preventDefault();\n      } else if (range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '*' || range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '-') {\n        range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n        this.applyListsHandler({\n          subCommand: 'UL',\n          callBack: e.callBack\n        });\n        e.event.preventDefault();\n      }\n    }\n  };\n  Lists.prototype.enterList = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    var startNode = range.startContainer.nodeName === 'LI' ? range.startContainer : range.startContainer.parentElement.closest('LI');\n    var endNode = range.endContainer.nodeName === 'LI' ? range.endContainer : range.endContainer.parentElement.closest('LI');\n    if (!isNOU(startNode) && !isNOU(endNode) && startNode === endNode && startNode.tagName === 'LI' && startNode.textContent.trim() === '' && startNode.querySelectorAll('IMG').length === 0) {\n      if (startNode.textContent.charCodeAt(0) === 65279) {\n        startNode.textContent = '';\n      }\n      var startNodeParent = startNode.parentElement;\n      if (isNOU(startNodeParent.parentElement.closest('UL')) && isNOU(startNodeParent.parentElement.closest('OL'))) {\n        if (!isNOU(startNode.nextElementSibling)) {\n          var nearBlockNode = this.parent.domNode.blockParentNode(startNode);\n          this.parent.nodeCutter.GetSpliceNode(range, nearBlockNode);\n        }\n        var insertTag = void 0;\n        if (e.enterAction === 'DIV') {\n          insertTag = createElement('div');\n          insertTag.innerHTML = '<br>';\n        } else if (e.enterAction === 'P') {\n          insertTag = createElement('p');\n          insertTag.innerHTML = '<br>';\n        } else {\n          insertTag = createElement('br');\n        }\n        this.parent.domNode.insertAfter(insertTag, startNodeParent);\n        e.event.preventDefault();\n        this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, insertTag, 0);\n        if (startNodeParent.textContent === '') {\n          detach(startNodeParent);\n        } else {\n          detach(startNode);\n        }\n      }\n    }\n  };\n  // eslint-disable-next-line\n  Lists.prototype.backspaceList = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n    var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n    startNode = startNode.nodeName === 'BR' ? startNode.parentElement : startNode;\n    endNode = endNode.nodeName === 'BR' ? endNode.parentElement : endNode;\n    if (startNode === endNode && !isNullOrUndefined(closest(startNode, 'li')) && (startNode.textContent.trim() === '' && startNode.textContent.charCodeAt(0) === 65279 || startNode.textContent.length === 1 && startNode.textContent.charCodeAt(0) === 8203)) {\n      startNode.textContent = '';\n    }\n    if (startNode === endNode && startNode.textContent === '') {\n      if (startNode.parentElement.tagName === 'LI' && endNode.parentElement.tagName === 'LI') {\n        detach(startNode);\n      } else if (startNode.closest('ul') || startNode.closest('ol')) {\n        var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n        if (parentList.firstElementChild === startNode && !isNOU(parentList.children[1]) && (parentList.children[1].tagName === 'OL' || parentList.children[1].tagName === 'UL')) {\n          if (parentList.tagName === parentList.children[1].tagName) {\n            while (parentList.children[1].lastChild) {\n              this.parent.domNode.insertAfter(parentList.children[1].lastChild, parentList.children[1]);\n            }\n            detach(parentList.children[1]);\n          } else {\n            parentList.parentElement.insertBefore(parentList.children[1], parentList);\n          }\n        }\n      }\n    } else if (!isNOU(startNode.firstChild) && startNode.firstChild.nodeName === 'BR' && !isNullOrUndefined(startNode.childNodes[1]) && (startNode.childNodes[1].nodeName === 'UL' || startNode.childNodes[1].nodeName === 'OL')) {\n      var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n      if (parentList.tagName === startNode.childNodes[1].nodeName) {\n        while (startNode.childNodes[1].lastChild) {\n          this.parent.domNode.insertAfter(startNode.children[1].lastChild, startNode);\n        }\n        detach(startNode.childNodes[1]);\n      } else {\n        parentList.parentElement.insertBefore(startNode.children[1], parentList);\n      }\n    }\n  };\n  Lists.prototype.keyDownHandler = function (e) {\n    if (e.event.which === 13) {\n      this.enterList(e);\n    }\n    if (e.event.which === 32) {\n      this.spaceList(e);\n    }\n    if (e.event.which === 8) {\n      this.backspaceList(e);\n    }\n    if (e.event.which === 46 && e.event.action === 'delete') {\n      var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n      var commonAncestor = range.commonAncestorContainer;\n      var startEle = range.startContainer;\n      var endEle = range.endContainer;\n      var startNode = startEle.nodeType === 3 ? startEle.parentElement : startEle;\n      var endNode = endEle.nodeType === 3 ? endEle.parentElement : endEle;\n      if ((commonAncestor.nodeName === 'UL' || commonAncestor.nodeName === 'OL') && startNode !== endNode && (!isNullOrUndefined(closest(startNode, 'ul')) || !isNullOrUndefined(closest(startNode, 'ol'))) && (!isNullOrUndefined(closest(endNode, 'ul')) || !isNullOrUndefined(closest(endNode, 'ol'))) && commonAncestor.lastElementChild === closest(endNode, 'li') && !range.collapsed) {\n        detach(commonAncestor);\n      }\n    }\n    if (e.event.which === 9) {\n      var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n      if (!(e.event.action && e.event.action === 'indent')) {\n        this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n      }\n      var blockNodes = void 0;\n      var startOffset = range.startOffset;\n      var endOffset = range.endOffset;\n      var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n      var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n      if (startNode === endNode && (startNode.nodeName === 'BR' || startNode.nodeName === '#text') && CONSTANT.IGNORE_BLOCK_TAGS.indexOf(startNode.parentNode.tagName.toLocaleLowerCase()) >= 0) {\n        return;\n      } else {\n        if (!(e.event.action && e.event.action === 'indent')) {\n          this.domNode.setMarker(this.saveSelection);\n        }\n        blockNodes = this.domNode.blockNodes();\n      }\n      var nodes = [];\n      var isNested = true;\n      for (var i = 0; i < blockNodes.length; i++) {\n        if (blockNodes[i].parentNode.tagName === 'LI') {\n          nodes.push(blockNodes[i].parentNode);\n        } else if (blockNodes[i].tagName === 'LI' && blockNodes[i].childNodes[0].tagName !== 'P' && blockNodes[i].childNodes[0].tagName !== 'OL' && blockNodes[i].childNodes[0].tagName !== 'UL') {\n          nodes.push(blockNodes[i]);\n        }\n      }\n      if (nodes.length > 1 || nodes.length && (startOffset === 0 && endOffset === 0 || e.ignoreDefault)) {\n        e.event.preventDefault();\n        e.event.stopPropagation();\n        this.currentAction = this.getAction(nodes[0]);\n        if (e.event.shiftKey) {\n          this.revertList(nodes);\n          this.revertClean();\n        } else {\n          isNested = this.nestedList(nodes);\n        }\n        if (isNested) {\n          this.cleanNode();\n          this.parent.editableElement.focus();\n        }\n        if (!(e.event.action && e.event.action === 'indent')) {\n          this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n          this.saveSelection.restore();\n          if (e.callBack) {\n            e.callBack({\n              requestType: this.currentAction,\n              editorMode: 'HTML',\n              range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n              elements: this.parent.domNode.blockNodes(),\n              event: e.event\n            });\n          }\n        }\n      } else {\n        if (!(e.event.action && e.event.action === 'indent')) {\n          if (e.event && e.event.shiftKey && e.event.key === 'Tab') {\n            e.event.action = 'tab';\n          }\n          this.saveSelection = this.domNode.saveMarker(this.saveSelection, e.event.action);\n          this.saveSelection.restore();\n        }\n      }\n    } else {\n      switch (e.event.action) {\n        case 'ordered-list':\n          this.applyListsHandler({\n            subCommand: 'OL',\n            callBack: e.callBack\n          });\n          e.event.preventDefault();\n          break;\n        case 'unordered-list':\n          this.applyListsHandler({\n            subCommand: 'UL',\n            callBack: e.callBack\n          });\n          e.event.preventDefault();\n          break;\n      }\n    }\n  };\n  Lists.prototype.spaceKeyAction = function (e) {\n    if (e.event.which === 32) {\n      this.spaceList(e);\n    }\n  };\n  Lists.prototype.getAction = function (element) {\n    var parentNode = element.parentNode;\n    return parentNode.nodeName === 'OL' ? 'OL' : 'UL';\n  };\n  Lists.prototype.revertClean = function () {\n    var collectionNodes = this.parent.editableElement.querySelectorAll('ul, ol');\n    for (var i = 0; i < collectionNodes.length; i++) {\n      var listNodes = collectionNodes[i].querySelectorAll('ul, ol');\n      if (listNodes.length > 0) {\n        for (var j = 0; j < listNodes.length; j++) {\n          var prevSibling = listNodes[j].previousSibling;\n          if (prevSibling && prevSibling.tagName === 'LI') {\n            prevSibling.appendChild(listNodes[j]);\n          }\n        }\n      }\n    }\n  };\n  Lists.prototype.noPreviousElement = function (elements) {\n    var firstNode;\n    var firstNodeOL;\n    var siblingListOL = elements.querySelectorAll('ol, ul');\n    var siblingListLI = elements.querySelectorAll('li');\n    var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n    if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n      firstNode = siblingListLI[0];\n    } else {\n      firstNodeOL = siblingListOL[0];\n    }\n    if (firstNode) {\n      for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n        var nextSibling = h.nextSibling;\n        prepend([h], firstNode);\n        setStyleAttribute(elements, {\n          'list-style-type': 'none'\n        });\n        setStyleAttribute(firstNode, {\n          'list-style-type': ''\n        });\n        h = nextSibling;\n      }\n    } else if (firstNodeOL) {\n      var nestedElement = createElement('li');\n      prepend([nestedElement], firstNodeOL);\n      for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n        var nextSibling = h.nextSibling;\n        nestedElement.appendChild(h);\n        h = nextSibling;\n      }\n      prepend([firstNodeOL], elements.parentNode);\n      detach(elements);\n      var nestedElementLI = createElement('li', {\n        styles: 'list-style-type: none;'\n      });\n      prepend([nestedElementLI], firstNodeOL.parentNode);\n      append([firstNodeOL], nestedElementLI);\n    } else {\n      var nestedElementLI = createElement('li', {\n        styles: 'list-style-type: none;'\n      });\n      prepend([nestedElementLI], elements.parentNode);\n      var nestedElement = createElement(elements.parentNode.tagName);\n      prepend([nestedElement], nestedElementLI);\n      append([elements], nestedElement);\n    }\n  };\n  Lists.prototype.nestedList = function (elements) {\n    var isNested = false;\n    for (var i = 0; i < elements.length; i++) {\n      var prevSibling = this.domNode.getPreviousNode(elements[i]);\n      if (prevSibling) {\n        isNested = true;\n        var firstNode = void 0;\n        var firstNodeLI = void 0;\n        var siblingListOL = elements[i].querySelectorAll('ol, ul');\n        var siblingListLI = elements[i].querySelectorAll('li');\n        var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n        if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n          firstNodeLI = siblingListLI[0];\n        } else {\n          firstNode = siblingListOL[0];\n        }\n        if (firstNode) {\n          var nestedElement = createElement('li');\n          prepend([nestedElement], firstNode);\n          for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n            var nextSibling = h.nextSibling;\n            nestedElement.appendChild(h);\n            h = nextSibling;\n          }\n          append([firstNode], prevSibling);\n          detach(elements[i]);\n        } else if (firstNodeLI) {\n          if (prevSibling.tagName === 'LI') {\n            for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n              var nextSibling = h.nextSibling;\n              prepend([h], firstNodeLI);\n              setStyleAttribute(elements[i], {\n                'list-style-type': 'none'\n              });\n              setStyleAttribute(firstNodeLI, {\n                'list-style-type': ''\n              });\n              h = nextSibling;\n            }\n            append([firstNodeLI.parentNode], prevSibling);\n            detach(elements[i]);\n          }\n        } else {\n          if (prevSibling.tagName === 'LI') {\n            var nestedElement = createElement(elements[i].parentNode.tagName);\n            append([nestedElement], prevSibling);\n            append([elements[i]], nestedElement);\n          }\n        }\n      } else {\n        var element = elements[i];\n        isNested = true;\n        this.noPreviousElement(element);\n      }\n    }\n    return isNested;\n  };\n  Lists.prototype.applyListsHandler = function (e) {\n    var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    if (range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement && range.startOffset === range.endOffset && range.startOffset === 0 && this.parent.editableElement.textContent.length === 0 && this.parent.editableElement.childNodes[0].nodeName != 'TABLE' && this.parent.editableElement.childNodes[0].nodeName != 'IMG') {\n      var focusNode = range.startContainer.childNodes[0];\n      this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, focusNode, focusNode, 0, 0);\n      range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n    }\n    this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n    this.currentAction = e.subCommand;\n    this.currentAction = e.subCommand = this.currentAction === 'NumberFormatList' ? 'OL' : this.currentAction === 'BulletFormatList' ? 'UL' : this.currentAction;\n    this.domNode.setMarker(this.saveSelection);\n    var listsNodes = this.domNode.blockNodes();\n    if (e.enterAction === 'BR') {\n      this.setSelectionBRConfig();\n      var allSelectedNode = this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument);\n      var selectedNodes = this.parent.nodeSelection.getSelectionNodes(allSelectedNode);\n      var currentFormatNodes = [];\n      if (selectedNodes.length === 0) {\n        selectedNodes.push(listsNodes[0]);\n      }\n      for (var i = 0; i < selectedNodes.length; i++) {\n        var currentNode = selectedNodes[i];\n        var previousCurrentNode = void 0;\n        while (!this.parent.domNode.isBlockNode(currentNode) && currentNode !== this.parent.editableElement) {\n          previousCurrentNode = currentNode;\n          currentNode = currentNode.parentElement;\n        }\n        if (this.parent.domNode.isBlockNode(currentNode) && currentNode === this.parent.editableElement) {\n          currentFormatNodes.push(previousCurrentNode);\n        }\n      }\n      for (var i = 0; i < currentFormatNodes.length; i++) {\n        if (!this.parent.domNode.isBlockNode(currentFormatNodes[i])) {\n          var currentNode = currentFormatNodes[i];\n          var previousNode = currentNode;\n          while (currentNode === this.parent.editableElement) {\n            previousNode = currentNode;\n            currentNode = currentNode.parentElement;\n          }\n          var tempElem = void 0;\n          if (this.parent.domNode.isBlockNode(previousNode.parentElement) && previousNode.parentElement === this.parent.editableElement) {\n            tempElem = createElement('p');\n            previousNode.parentElement.insertBefore(tempElem, previousNode);\n            tempElem.appendChild(previousNode);\n          } else {\n            tempElem = previousNode;\n          }\n          var preNode = tempElem.previousSibling;\n          while (!isNOU(preNode) && preNode.nodeName !== 'BR' && !this.parent.domNode.isBlockNode(preNode)) {\n            tempElem.firstChild.parentElement.insertBefore(preNode, tempElem.firstChild);\n            preNode = tempElem.previousSibling;\n          }\n          if (!isNOU(preNode) && preNode.nodeName === 'BR') {\n            detach(preNode);\n          }\n          var postNode = tempElem.nextSibling;\n          while (!isNOU(postNode) && postNode.nodeName !== 'BR' && !this.parent.domNode.isBlockNode(postNode)) {\n            tempElem.appendChild(postNode);\n            postNode = tempElem.nextSibling;\n          }\n          if (!isNOU(postNode) && postNode.nodeName === 'BR') {\n            detach(postNode);\n          }\n        }\n      }\n      this.setSelectionBRConfig();\n      listsNodes = this.parent.domNode.blockNodes();\n    }\n    for (var i = 0; i < listsNodes.length; i++) {\n      if (listsNodes[i].tagName === 'TABLE' && !range.collapsed) {\n        listsNodes.splice(i, 1);\n      }\n      if (listsNodes.length > 0 && listsNodes[i].tagName !== 'LI' && 'LI' === listsNodes[i].parentNode.tagName) {\n        listsNodes[i] = listsNodes[i].parentNode;\n      }\n    }\n    this.applyLists(listsNodes, this.currentAction, e.selector, e.item);\n    if (e.callBack) {\n      e.callBack({\n        requestType: this.currentAction,\n        event: e.event,\n        editorMode: 'HTML',\n        range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n        elements: this.parent.domNode.blockNodes()\n      });\n    }\n  };\n  Lists.prototype.setSelectionBRConfig = function () {\n    var startElem = this.parent.editableElement.querySelector('.' + markerClassName.startSelection);\n    var endElem = this.parent.editableElement.querySelector('.' + markerClassName.endSelection);\n    if (isNOU(endElem)) {\n      this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, startElem, 0);\n    } else {\n      this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, startElem, endElem, 0, 0);\n    }\n  };\n  Lists.prototype.applyLists = function (elements, type, selector, item) {\n    var isReverse = true;\n    if (this.isRevert(elements, type) && isNOU(item)) {\n      this.revertList(elements);\n      this.removeEmptyListElements();\n    } else {\n      this.checkLists(elements, type, item);\n      for (var i = 0; i < elements.length; i++) {\n        if (!isNOU(item) && !isNOU(item.listStyle)) {\n          if (item.listStyle === 'listImage') {\n            setStyleAttribute(elements[i], {\n              'list-style-image': item.listImage\n            });\n          } else {\n            setStyleAttribute(elements[i], {\n              'list-style-image': 'none'\n            });\n            setStyleAttribute(elements[i], {\n              'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()\n            });\n          }\n        }\n        if (elements[i].getAttribute('contenteditable') === 'true' && elements[i].childNodes.length === 1 && elements[i].childNodes[0].nodeName === 'TABLE') {\n          var listEle = document.createElement(type);\n          listEle.innerHTML = '<li><br/></li>';\n          elements[i].appendChild(listEle);\n        } else if ('LI' !== elements[i].tagName && isNOU(item)) {\n          isReverse = false;\n          var elemAtt = elements[i].tagName === 'IMG' ? '' : this.domNode.attributes(elements[i]);\n          var openTag = '<' + type + '>';\n          var closeTag = '</' + type + '>';\n          var newTag = 'li' + elemAtt;\n          var replaceHTML = elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ? elements[i].innerHTML : elements[i].outerHTML;\n          var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n          var collectionString = openTag + innerHTML + closeTag;\n          this.domNode.replaceWith(elements[i], collectionString);\n        } else if (!isNOU(item) && 'LI' !== elements[i].tagName) {\n          // eslint-disable-next-line\n          isReverse = false;\n          var elemAtt = elements[i].tagName === 'IMG' ? '' : this.domNode.attributes(elements[i]);\n          var openTag = '<' + type + elemAtt + '>';\n          var closeTag = '</' + type + '>';\n          var newTag = 'li';\n          var replaceHTML = elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ? elements[i].innerHTML : elements[i].outerHTML;\n          var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n          var collectionString = openTag + innerHTML + closeTag;\n          this.domNode.replaceWith(elements[i], collectionString);\n        }\n      }\n    }\n    this.cleanNode();\n    this.parent.editableElement.focus();\n    if (isIDevice()) {\n      setEditFrameFocus(this.parent.editableElement, selector);\n    }\n    this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n    this.saveSelection.restore();\n  };\n  Lists.prototype.removeEmptyListElements = function () {\n    var listElem = this.parent.editableElement.querySelectorAll('ol, ul');\n    for (var i = 0; i < listElem.length; i++) {\n      if (listElem[i].textContent.trim() === '') {\n        detach(listElem[i]);\n      }\n    }\n  };\n  Lists.prototype.isRevert = function (nodes, tagName) {\n    var isRevert = true;\n    for (var i = 0; i < nodes.length; i++) {\n      if (nodes[i].tagName !== 'LI') {\n        return false;\n      }\n      if (nodes[i].parentNode.tagName !== tagName) {\n        isRevert = false;\n      }\n    }\n    return isRevert;\n  };\n  Lists.prototype.checkLists = function (nodes, tagName, item) {\n    var nodesTemp = [];\n    for (var i = 0; i < nodes.length; i++) {\n      var node = nodes[i].parentNode;\n      if (!isNOU(item) && 'LI' === nodes[i].tagName && !isNOU(item.listStyle)) {\n        if (item.listStyle === 'listImage') {\n          setStyleAttribute(node, {\n            'list-style-image': item.listImage\n          });\n        } else {\n          setStyleAttribute(node, {\n            'list-style-image': 'none'\n          });\n          setStyleAttribute(node, {\n            'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()\n          });\n        }\n      }\n      if (nodes[i].tagName === 'LI' && node.tagName !== tagName && nodesTemp.indexOf(node) < 0 || nodes[i].tagName === 'LI' && node.tagName === tagName && nodesTemp.indexOf(node) < 0 && item !== null) {\n        nodesTemp.push(node);\n      }\n    }\n    for (var j = nodesTemp.length - 1; j >= 0; j--) {\n      var h = nodesTemp[j];\n      var replace = '<' + tagName.toLowerCase() + ' ' + this.domNode.attributes(h) + '>' + h.innerHTML + '</' + tagName.toLowerCase() + '>';\n      this.domNode.replaceWith(nodesTemp[j], replace);\n    }\n  };\n  Lists.prototype.cleanNode = function () {\n    var liParents = this.parent.editableElement.querySelectorAll('ol + ol, ul + ul');\n    for (var c = 0; c < liParents.length; c++) {\n      var node = liParents[c];\n      if (this.domNode.isList(node.previousElementSibling) && this.domNode.openTagString(node) === this.domNode.openTagString(node.previousElementSibling)) {\n        var contentNodes = this.domNode.contents(node);\n        for (var f = 0; f < contentNodes.length; f++) {\n          node.previousElementSibling.appendChild(contentNodes[f]);\n        }\n        node.parentNode.removeChild(node);\n      }\n    }\n  };\n  Lists.prototype.findUnSelected = function (temp, elements) {\n    temp = temp.slice().reverse();\n    if (temp.length > 0) {\n      var rightIndent = [];\n      var indentElements = [];\n      var lastElement = elements[elements.length - 1];\n      var lastElementChild = [];\n      var childElements = [];\n      lastElementChild = lastElement.childNodes;\n      for (var z = 0; z < lastElementChild.length; z++) {\n        if (lastElementChild[z].tagName === 'OL' || lastElementChild[z].tagName === 'UL') {\n          var childLI = lastElementChild[z].querySelectorAll('li');\n          if (childLI.length > 0) {\n            for (var y = 0; y < childLI.length; y++) {\n              childElements.push(childLI[y]);\n            }\n          }\n        }\n      }\n      for (var i = 0; i < childElements.length; i++) {\n        var count = 0;\n        for (var j = 0; j < temp.length; j++) {\n          if (!childElements[i].contains(temp[j])) {\n            count = count + 1;\n          }\n        }\n        if (count === temp.length) {\n          indentElements.push(childElements[i]);\n        }\n      }\n      if (indentElements.length > 0) {\n        for (var x = 0; x < indentElements.length; x++) {\n          if (this.domNode.contents(indentElements[x])[0].nodeName !== 'OL' && this.domNode.contents(indentElements[x])[0].nodeName !== 'UL') {\n            rightIndent.push(indentElements[x]);\n          }\n        }\n      }\n      if (rightIndent.length > 0) {\n        this.nestedList(rightIndent);\n      }\n    }\n  };\n  Lists.prototype.revertList = function (elements) {\n    var temp = [];\n    for (var i = elements.length - 1; i >= 0; i--) {\n      for (var j = i - 1; j >= 0; j--) {\n        if (elements[j].contains(elements[i]) || elements[j] === elements[i]) {\n          temp.push(elements[i]);\n          elements.splice(i, 1);\n          break;\n        }\n      }\n    }\n    this.findUnSelected(temp, elements);\n    var viewNode = [];\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      if (this.domNode.contents(element)[0].nodeType === 3 && this.domNode.contents(element)[0].textContent.trim().length === 0) {\n        detach(this.domNode.contents(element)[0]);\n      }\n      var parentNode = elements[i].parentNode;\n      var className = element.getAttribute('class');\n      if (temp.length === 0) {\n        var siblingList = elements[i].querySelectorAll('ul, ol');\n        var firstNode = siblingList[0];\n        if (firstNode) {\n          var child = firstNode.querySelectorAll('li');\n          if (child) {\n            var nestedElement = createElement(firstNode.tagName);\n            append([nestedElement], firstNode.parentNode);\n            var nestedElementLI = createElement('li', {\n              styles: 'list-style-type: none;'\n            });\n            append([nestedElementLI], nestedElement);\n            append([firstNode], nestedElementLI);\n          }\n        }\n      }\n      if (element.parentNode.insertBefore(this.closeTag(parentNode.tagName), element), 'LI' === parentNode.parentNode.tagName) {\n        element.parentNode.insertBefore(this.closeTag('LI'), element);\n      } else {\n        var classAttr = '';\n        if (className) {\n          // eslint-disable-next-line\n          classAttr += ' class=\"' + className + '\"';\n        }\n        if (CONSTANT.DEFAULT_TAG && 0 === element.querySelectorAll(CONSTANT.BLOCK_TAGS.join(', ')).length) {\n          var wrapperclass = isNullOrUndefined(className) ? ' class=\"e-rte-wrap-inner\"' : ' class=\"' + className + ' e-rte-wrap-inner\"';\n          var wrapper = '<' + CONSTANT.DEFAULT_TAG + wrapperclass + this.domNode.attributes(parentNode) + '></' + CONSTANT.DEFAULT_TAG + '>';\n          this.domNode.wrapInner(element, this.domNode.parseHTMLFragment(wrapper));\n        } else if (this.domNode.contents(element)[0].nodeType === 3) {\n          var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.parent.domNode.encode(this.domNode.contents(element)[0].textContent));\n          this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n        } else if (this.domNode.contents(element)[0].classList.contains(markerClassName.startSelection) || this.domNode.contents(element)[0].classList.contains(markerClassName.endSelection)) {\n          var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.domNode.contents(element)[0].outerHTML);\n          this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n        } else {\n          var childNode = element.firstChild;\n          className = childNode.getAttribute('class');\n          attributes(childNode, this.domNode.rawAttributes(parentNode));\n          if (className && childNode.getAttribute('class')) {\n            attributes(childNode, {\n              'class': className + ' ' + childNode.getAttribute('class')\n            });\n          }\n        }\n        append([this.openTag('LI')], element);\n        prepend([this.closeTag('LI')], element);\n      }\n      this.domNode.insertAfter(this.openTag(parentNode.tagName), element);\n      if (parentNode.parentNode.tagName === 'LI') {\n        parentNode = parentNode.parentNode.parentNode;\n      }\n      if (viewNode.indexOf(parentNode) < 0) {\n        viewNode.push(parentNode);\n      }\n    }\n    for (var i = 0; i < viewNode.length; i++) {\n      var node = viewNode[i];\n      var nodeInnerHtml = node.innerHTML;\n      var closeTag = /<span class=\"e-rte-list-close-([a-z]*)\"><\\/span>/g;\n      var openTag = /<span class=\"e-rte-list-open-([a-z]*)\"><\\/span>/g;\n      nodeInnerHtml = nodeInnerHtml.replace(closeTag, '</$1>');\n      nodeInnerHtml = nodeInnerHtml.replace(openTag, '<$1 ' + this.domNode.attributes(node) + '>');\n      this.domNode.replaceWith(node, this.domNode.openTagString(node) + nodeInnerHtml.trim() + this.domNode.closeTagString(node));\n    }\n    var emptyUl = this.parent.editableElement.querySelectorAll('ul:empty, ol:empty');\n    for (var i = 0; i < emptyUl.length; i++) {\n      detach(emptyUl[i]);\n    }\n    var emptyLi = this.parent.editableElement.querySelectorAll('li:empty');\n    for (var i = 0; i < emptyLi.length; i++) {\n      detach(emptyLi[i]);\n    }\n  };\n  Lists.prototype.openTag = function (type) {\n    return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-open-' + type.toLowerCase() + '\"></span>');\n  };\n  Lists.prototype.closeTag = function (type) {\n    return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-close-' + type.toLowerCase() + '\"></span>');\n  };\n  return Lists;\n}();\nexport { Lists };","map":{"version":3,"names":["CONSTANT","createElement","detach","prepend","append","attributes","markerClassName","EVENTS","setStyleAttribute","isIDevice","setEditFrameFocus","isNullOrUndefined","isNOU","closest","Lists","parent","domNode","addEventListener","prototype","observer","on","LIST_TYPE","applyListsHandler","KEY_DOWN_HANDLER","keyDownHandler","SPACE_ACTION","spaceKeyAction","testList","elem","olListRegex","elementStart","innerText","trim","split","i","length","test","testCurrentList","range","olListStartRegex","startContainer","textContent","slice","startOffset","currentContent","replace","spaceList","e","nodeSelection","getRange","currentDocument","saveSelection","save","startNode","getSelectedNode","endNode","endContainer","endOffset","preElement","previousElementSibling","nextElement","nextElementSibling","preElemULStart","substring","nextElemULStart","startElementOLTest","preElementOLTest","nextElementOLTest","subCommand","callBack","event","preventDefault","enterList","nodeName","parentElement","tagName","querySelectorAll","charCodeAt","startNodeParent","nearBlockNode","blockParentNode","nodeCutter","GetSpliceNode","insertTag","enterAction","innerHTML","insertAfter","setCursorPoint","backspaceList","parentList","firstElementChild","children","lastChild","insertBefore","firstChild","childNodes","which","action","commonAncestor","commonAncestorContainer","startEle","endEle","nodeType","lastElementChild","collapsed","blockNodes","IGNORE_BLOCK_TAGS","indexOf","parentNode","toLocaleLowerCase","setMarker","nodes","isNested","push","ignoreDefault","stopPropagation","currentAction","getAction","shiftKey","revertList","revertClean","nestedList","cleanNode","editableElement","focus","saveMarker","restore","requestType","editorMode","elements","key","element","collectionNodes","listNodes","j","prevSibling","previousSibling","appendChild","noPreviousElement","firstNode","firstNodeOL","siblingListOL","siblingListLI","siblingListLIFirst","contents","h","isList","nextSibling","nestedElement","nestedElementLI","styles","getPreviousNode","firstNodeLI","focusNode","setSelectionText","listsNodes","setSelectionBRConfig","allSelectedNode","getSelectedNodes","selectedNodes","getSelectionNodes","currentFormatNodes","currentNode","previousCurrentNode","isBlockNode","previousNode","tempElem","preNode","postNode","splice","applyLists","selector","item","startElem","querySelector","startSelection","endElem","endSelection","type","isReverse","isRevert","removeEmptyListElements","checkLists","listStyle","listImage","toLowerCase","getAttribute","listEle","document","elemAtt","openTag","closeTag","newTag","replaceHTML","DEFAULT_TAG","outerHTML","createTagString","collectionString","replaceWith","listElem","nodesTemp","node","liParents","c","openTagString","contentNodes","f","removeChild","findUnSelected","temp","reverse","rightIndent","indentElements","lastElement","childElements","z","childLI","y","count","contains","x","viewNode","className","siblingList","child","classAttr","BLOCK_TAGS","join","wrapperclass","wrapper","wrapInner","parseHTMLFragment","encode","classList","childNode","rawAttributes","nodeInnerHtml","closeTagString","emptyUl","emptyLi"],"sources":["D:/USPERSO IMPLEMENTATION/Projet_DevIII/frontend/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/lists.js"],"sourcesContent":["import * as CONSTANT from './../base/constant';\nimport { createElement, detach, prepend, append, attributes } from '@syncfusion/ej2-base';\nimport { markerClassName } from './dom-node';\nimport * as EVENTS from './../../common/constant';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isIDevice, setEditFrameFocus } from '../../common/util';\nimport { isNullOrUndefined, isNullOrUndefined as isNOU, closest } from '@syncfusion/ej2-base';\n/**\n * Lists internal component\n *\n * @hidden\n\n */\nvar Lists = /** @class */ (function () {\n    /**\n     * Constructor for creating the Lists plugin\n     *\n     * @param {EditorManager} parent - specifies the parent element\n     * @hidden\n\n     */\n    function Lists(parent) {\n        this.parent = parent;\n        this.domNode = this.parent.domNode;\n        this.addEventListener();\n    }\n    Lists.prototype.addEventListener = function () {\n        this.parent.observer.on(EVENTS.LIST_TYPE, this.applyListsHandler, this);\n        this.parent.observer.on(EVENTS.KEY_DOWN_HANDLER, this.keyDownHandler, this);\n        this.parent.observer.on(EVENTS.SPACE_ACTION, this.spaceKeyAction, this);\n    };\n    Lists.prototype.testList = function (elem) {\n        var olListRegex = [/^[\\d]+[.]+$/,\n            /^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,\n            /^[a-zA-Z][.]+$/];\n        var elementStart = !isNullOrUndefined(elem) ? elem.innerText.trim().split('.')[0] + '.' : null;\n        if (!isNullOrUndefined(elementStart)) {\n            for (var i = 0; i < olListRegex.length; i++) {\n                if (olListRegex[i].test(elementStart)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Lists.prototype.testCurrentList = function (range) {\n        var olListStartRegex = [/^[1]+[.]+$/, /^[i]+[.]+$/, /^[a]+[.]+$/];\n        if (!isNullOrUndefined(range.startContainer.textContent.slice(0, range.startOffset))) {\n            var currentContent = range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim();\n            for (var i = 0; i < olListStartRegex.length; i++) {\n                if (olListStartRegex[i].test(currentContent) && currentContent.length === 2) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Lists.prototype.spaceList = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n        var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n        // eslint-disable-next-line\n        var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n        var preElement = startNode.previousElementSibling;\n        var nextElement = startNode.nextElementSibling;\n        var preElemULStart = !isNullOrUndefined(preElement) ?\n            preElement.innerText.trim().substring(0, 1) : null;\n        var nextElemULStart = !isNullOrUndefined(nextElement) ?\n            nextElement.innerText.trim().substring(0, 1) : null;\n        var startElementOLTest = this.testCurrentList(range);\n        var preElementOLTest = this.testList(preElement);\n        var nextElementOLTest = this.testList(nextElement);\n        if (!preElementOLTest && !nextElementOLTest && preElemULStart !== '*' && nextElemULStart !== '*') {\n            if (startElementOLTest) {\n                range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n                this.applyListsHandler({ subCommand: 'OL', callBack: e.callBack });\n                e.event.preventDefault();\n            }\n            else if (range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '*' ||\n                range.startContainer.textContent.replace(/\\u200B/g, '').slice(0, range.startOffset).trim() === '-') {\n                range.startContainer.textContent = range.startContainer.textContent.slice(range.startOffset, range.startContainer.textContent.length);\n                this.applyListsHandler({ subCommand: 'UL', callBack: e.callBack });\n                e.event.preventDefault();\n            }\n        }\n    };\n    Lists.prototype.enterList = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        var startNode = range.startContainer.nodeName === 'LI' ? range.startContainer :\n            range.startContainer.parentElement.closest('LI');\n        var endNode = range.endContainer.nodeName === 'LI' ? range.endContainer :\n            range.endContainer.parentElement.closest('LI');\n        if (!isNOU(startNode) && !isNOU(endNode) && startNode === endNode && startNode.tagName === 'LI' &&\n            startNode.textContent.trim() === '' && startNode.querySelectorAll('IMG').length === 0) {\n            if (startNode.textContent.charCodeAt(0) === 65279) {\n                startNode.textContent = '';\n            }\n            var startNodeParent = startNode.parentElement;\n            if (isNOU(startNodeParent.parentElement.closest('UL')) && isNOU(startNodeParent.parentElement.closest('OL'))) {\n                if (!isNOU(startNode.nextElementSibling)) {\n                    var nearBlockNode = this.parent.domNode.blockParentNode(startNode);\n                    this.parent.nodeCutter.GetSpliceNode(range, nearBlockNode);\n                }\n                var insertTag = void 0;\n                if (e.enterAction === 'DIV') {\n                    insertTag = createElement('div');\n                    insertTag.innerHTML = '<br>';\n                }\n                else if (e.enterAction === 'P') {\n                    insertTag = createElement('p');\n                    insertTag.innerHTML = '<br>';\n                }\n                else {\n                    insertTag = createElement('br');\n                }\n                this.parent.domNode.insertAfter(insertTag, startNodeParent);\n                e.event.preventDefault();\n                this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, insertTag, 0);\n                if (startNodeParent.textContent === '') {\n                    detach(startNodeParent);\n                }\n                else {\n                    detach(startNode);\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    Lists.prototype.backspaceList = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n        var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n        startNode = startNode.nodeName === 'BR' ? startNode.parentElement : startNode;\n        endNode = endNode.nodeName === 'BR' ? endNode.parentElement : endNode;\n        if (startNode === endNode && !isNullOrUndefined(closest(startNode, 'li')) &&\n            ((startNode.textContent.trim() === '' && startNode.textContent.charCodeAt(0) === 65279) ||\n                (startNode.textContent.length === 1 && startNode.textContent.charCodeAt(0) === 8203))) {\n            startNode.textContent = '';\n        }\n        if (startNode === endNode && startNode.textContent === '') {\n            if (startNode.parentElement.tagName === 'LI' && endNode.parentElement.tagName === 'LI') {\n                detach(startNode);\n            }\n            else if (startNode.closest('ul') || startNode.closest('ol')) {\n                var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n                if (parentList.firstElementChild === startNode && !isNOU(parentList.children[1]) &&\n                    (parentList.children[1].tagName === 'OL' || parentList.children[1].tagName === 'UL')) {\n                    if (parentList.tagName === parentList.children[1].tagName) {\n                        while (parentList.children[1].lastChild) {\n                            this.parent.domNode.insertAfter(parentList.children[1].lastChild, parentList.children[1]);\n                        }\n                        detach(parentList.children[1]);\n                    }\n                    else {\n                        parentList.parentElement.insertBefore(parentList.children[1], parentList);\n                    }\n                }\n            }\n        }\n        else if (!isNOU(startNode.firstChild) && startNode.firstChild.nodeName === 'BR' &&\n            (!isNullOrUndefined(startNode.childNodes[1]) && (startNode.childNodes[1].nodeName === 'UL' ||\n                startNode.childNodes[1].nodeName === 'OL'))) {\n            var parentList = !isNOU(startNode.closest('ul')) ? startNode.closest('ul') : startNode.closest('ol');\n            if (parentList.tagName === startNode.childNodes[1].nodeName) {\n                while (startNode.childNodes[1].lastChild) {\n                    this.parent.domNode.insertAfter(startNode.children[1].lastChild, startNode);\n                }\n                detach(startNode.childNodes[1]);\n            }\n            else {\n                parentList.parentElement.insertBefore(startNode.children[1], parentList);\n            }\n        }\n    };\n    Lists.prototype.keyDownHandler = function (e) {\n        if (e.event.which === 13) {\n            this.enterList(e);\n        }\n        if (e.event.which === 32) {\n            this.spaceList(e);\n        }\n        if (e.event.which === 8) {\n            this.backspaceList(e);\n        }\n        if (e.event.which === 46 && e.event.action === 'delete') {\n            var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n            var commonAncestor = range.commonAncestorContainer;\n            var startEle = range.startContainer;\n            var endEle = range.endContainer;\n            var startNode = startEle.nodeType === 3 ? startEle.parentElement : startEle;\n            var endNode = endEle.nodeType === 3 ? endEle.parentElement : endEle;\n            if ((commonAncestor.nodeName === 'UL' || commonAncestor.nodeName === 'OL') && startNode !== endNode\n                && (!isNullOrUndefined(closest(startNode, 'ul')) || !isNullOrUndefined(closest(startNode, 'ol')))\n                && (!isNullOrUndefined(closest(endNode, 'ul')) || !isNullOrUndefined(closest(endNode, 'ol')))\n                && (commonAncestor.lastElementChild === closest(endNode, 'li')) && !range.collapsed) {\n                detach(commonAncestor);\n            }\n        }\n        if (e.event.which === 9) {\n            var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n            if (!(e.event.action && e.event.action === 'indent')) {\n                this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n            }\n            var blockNodes = void 0;\n            var startOffset = range.startOffset;\n            var endOffset = range.endOffset;\n            var startNode = this.parent.domNode.getSelectedNode(range.startContainer, range.startOffset);\n            var endNode = this.parent.domNode.getSelectedNode(range.endContainer, range.endOffset);\n            if ((startNode === endNode && (startNode.nodeName === 'BR' || startNode.nodeName === '#text') &&\n                CONSTANT.IGNORE_BLOCK_TAGS.indexOf(startNode.parentNode.tagName.toLocaleLowerCase()) >= 0)) {\n                return;\n            }\n            else {\n                if (!(e.event.action && e.event.action === 'indent')) {\n                    this.domNode.setMarker(this.saveSelection);\n                }\n                blockNodes = this.domNode.blockNodes();\n            }\n            var nodes = [];\n            var isNested = true;\n            for (var i = 0; i < blockNodes.length; i++) {\n                if (blockNodes[i].parentNode.tagName === 'LI') {\n                    nodes.push(blockNodes[i].parentNode);\n                }\n                else if (blockNodes[i].tagName === 'LI' && blockNodes[i].childNodes[0].tagName !== 'P' &&\n                    (blockNodes[i].childNodes[0].tagName !== 'OL' &&\n                        blockNodes[i].childNodes[0].tagName !== 'UL')) {\n                    nodes.push(blockNodes[i]);\n                }\n            }\n            if (nodes.length > 1 || nodes.length && ((startOffset === 0 && endOffset === 0) || e.ignoreDefault)) {\n                e.event.preventDefault();\n                e.event.stopPropagation();\n                this.currentAction = this.getAction(nodes[0]);\n                if (e.event.shiftKey) {\n                    this.revertList(nodes);\n                    this.revertClean();\n                }\n                else {\n                    isNested = this.nestedList(nodes);\n                }\n                if (isNested) {\n                    this.cleanNode();\n                    this.parent.editableElement.focus();\n                }\n                if (!(e.event.action && e.event.action === 'indent')) {\n                    this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n                    this.saveSelection.restore();\n                    if (e.callBack) {\n                        e.callBack({\n                            requestType: this.currentAction,\n                            editorMode: 'HTML',\n                            range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                            elements: this.parent.domNode.blockNodes(),\n                            event: e.event\n                        });\n                    }\n                }\n            }\n            else {\n                if (!(e.event.action && e.event.action === 'indent')) {\n                    if (e.event && e.event.shiftKey && e.event.key === 'Tab') {\n                        e.event.action = 'tab';\n                    }\n                    this.saveSelection = this.domNode.saveMarker(this.saveSelection, e.event.action);\n                    this.saveSelection.restore();\n                }\n            }\n        }\n        else {\n            switch (e.event.action) {\n                case 'ordered-list':\n                    this.applyListsHandler({ subCommand: 'OL', callBack: e.callBack });\n                    e.event.preventDefault();\n                    break;\n                case 'unordered-list':\n                    this.applyListsHandler({ subCommand: 'UL', callBack: e.callBack });\n                    e.event.preventDefault();\n                    break;\n            }\n        }\n    };\n    Lists.prototype.spaceKeyAction = function (e) {\n        if (e.event.which === 32) {\n            this.spaceList(e);\n        }\n    };\n    Lists.prototype.getAction = function (element) {\n        var parentNode = element.parentNode;\n        return (parentNode.nodeName === 'OL' ? 'OL' : 'UL');\n    };\n    Lists.prototype.revertClean = function () {\n        var collectionNodes = this.parent.editableElement.querySelectorAll('ul, ol');\n        for (var i = 0; i < collectionNodes.length; i++) {\n            var listNodes = collectionNodes[i].querySelectorAll('ul, ol');\n            if (listNodes.length > 0) {\n                for (var j = 0; j < listNodes.length; j++) {\n                    var prevSibling = listNodes[j].previousSibling;\n                    if (prevSibling && prevSibling.tagName === 'LI') {\n                        prevSibling.appendChild(listNodes[j]);\n                    }\n                }\n            }\n        }\n    };\n    Lists.prototype.noPreviousElement = function (elements) {\n        var firstNode;\n        var firstNodeOL;\n        var siblingListOL = elements.querySelectorAll('ol, ul');\n        var siblingListLI = elements\n            .querySelectorAll('li');\n        var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n        if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n            firstNode = siblingListLI[0];\n        }\n        else {\n            firstNodeOL = siblingListOL[0];\n        }\n        if (firstNode) {\n            for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n                var nextSibling = h.nextSibling;\n                prepend([h], firstNode);\n                setStyleAttribute(elements, { 'list-style-type': 'none' });\n                setStyleAttribute(firstNode, { 'list-style-type': '' });\n                h = nextSibling;\n            }\n        }\n        else if (firstNodeOL) {\n            var nestedElement = createElement('li');\n            prepend([nestedElement], firstNodeOL);\n            for (var h = this.domNode.contents(elements)[0]; h && !this.domNode.isList(h); null) {\n                var nextSibling = h.nextSibling;\n                nestedElement.appendChild(h);\n                h = nextSibling;\n            }\n            prepend([firstNodeOL], elements.parentNode);\n            detach(elements);\n            var nestedElementLI = createElement('li', { styles: 'list-style-type: none;' });\n            prepend([nestedElementLI], firstNodeOL.parentNode);\n            append([firstNodeOL], nestedElementLI);\n        }\n        else {\n            var nestedElementLI = createElement('li', { styles: 'list-style-type: none;' });\n            prepend([nestedElementLI], elements.parentNode);\n            var nestedElement = createElement(elements.parentNode.tagName);\n            prepend([nestedElement], nestedElementLI);\n            append([elements], nestedElement);\n        }\n    };\n    Lists.prototype.nestedList = function (elements) {\n        var isNested = false;\n        for (var i = 0; i < elements.length; i++) {\n            var prevSibling = this.domNode.getPreviousNode(elements[i]);\n            if (prevSibling) {\n                isNested = true;\n                var firstNode = void 0;\n                var firstNodeLI = void 0;\n                var siblingListOL = elements[i].querySelectorAll('ol, ul');\n                var siblingListLI = elements[i]\n                    .querySelectorAll('li');\n                var siblingListLIFirst = this.domNode.contents(siblingListLI[0])[0];\n                if (siblingListLI.length > 0 && (siblingListLIFirst.nodeName === 'OL' || siblingListLIFirst.nodeName === 'UL')) {\n                    firstNodeLI = siblingListLI[0];\n                }\n                else {\n                    firstNode = siblingListOL[0];\n                }\n                if (firstNode) {\n                    var nestedElement = createElement('li');\n                    prepend([nestedElement], firstNode);\n                    for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n                        var nextSibling = h.nextSibling;\n                        nestedElement.appendChild(h);\n                        h = nextSibling;\n                    }\n                    append([firstNode], prevSibling);\n                    detach(elements[i]);\n                }\n                else if (firstNodeLI) {\n                    if (prevSibling.tagName === 'LI') {\n                        for (var h = this.domNode.contents(elements[i])[0]; h && !this.domNode.isList(h); null) {\n                            var nextSibling = h.nextSibling;\n                            prepend([h], firstNodeLI);\n                            setStyleAttribute(elements[i], { 'list-style-type': 'none' });\n                            setStyleAttribute(firstNodeLI, { 'list-style-type': '' });\n                            h = nextSibling;\n                        }\n                        append([firstNodeLI.parentNode], prevSibling);\n                        detach(elements[i]);\n                    }\n                }\n                else {\n                    if (prevSibling.tagName === 'LI') {\n                        var nestedElement = createElement(elements[i].parentNode.tagName);\n                        append([nestedElement], prevSibling);\n                        append([elements[i]], nestedElement);\n                    }\n                }\n            }\n            else {\n                var element = elements[i];\n                isNested = true;\n                this.noPreviousElement(element);\n            }\n        }\n        return isNested;\n    };\n    Lists.prototype.applyListsHandler = function (e) {\n        var range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        if (range.startContainer === range.endContainer && range.startContainer === this.parent.editableElement &&\n            range.startOffset === range.endOffset && range.startOffset === 0 &&\n            this.parent.editableElement.textContent.length === 0 && (this.parent.editableElement.childNodes[0].nodeName != 'TABLE' &&\n            this.parent.editableElement.childNodes[0].nodeName != 'IMG')) {\n            var focusNode = range.startContainer.childNodes[0];\n            this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, focusNode, focusNode, 0, 0);\n            range = this.parent.nodeSelection.getRange(this.parent.currentDocument);\n        }\n        this.saveSelection = this.parent.nodeSelection.save(range, this.parent.currentDocument);\n        this.currentAction = e.subCommand;\n        this.currentAction = e.subCommand = this.currentAction === 'NumberFormatList' ? 'OL' : this.currentAction === 'BulletFormatList' ? 'UL' : this.currentAction;\n        this.domNode.setMarker(this.saveSelection);\n        var listsNodes = this.domNode.blockNodes();\n        if (e.enterAction === 'BR') {\n            this.setSelectionBRConfig();\n            var allSelectedNode = this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument);\n            var selectedNodes = this.parent.nodeSelection.getSelectionNodes(allSelectedNode);\n            var currentFormatNodes = [];\n            if (selectedNodes.length === 0) {\n                selectedNodes.push(listsNodes[0]);\n            }\n            for (var i = 0; i < selectedNodes.length; i++) {\n                var currentNode = selectedNodes[i];\n                var previousCurrentNode = void 0;\n                while (!this.parent.domNode.isBlockNode(currentNode) && currentNode !== this.parent.editableElement) {\n                    previousCurrentNode = currentNode;\n                    currentNode = currentNode.parentElement;\n                }\n                if (this.parent.domNode.isBlockNode(currentNode) && currentNode === this.parent.editableElement) {\n                    currentFormatNodes.push(previousCurrentNode);\n                }\n            }\n            for (var i = 0; i < currentFormatNodes.length; i++) {\n                if (!this.parent.domNode.isBlockNode(currentFormatNodes[i])) {\n                    var currentNode = currentFormatNodes[i];\n                    var previousNode = currentNode;\n                    while (currentNode === this.parent.editableElement) {\n                        previousNode = currentNode;\n                        currentNode = currentNode.parentElement;\n                    }\n                    var tempElem = void 0;\n                    if (this.parent.domNode.isBlockNode(previousNode.parentElement) &&\n                        previousNode.parentElement === this.parent.editableElement) {\n                        tempElem = createElement('p');\n                        previousNode.parentElement.insertBefore(tempElem, previousNode);\n                        tempElem.appendChild(previousNode);\n                    }\n                    else {\n                        tempElem = previousNode;\n                    }\n                    var preNode = tempElem.previousSibling;\n                    while (!isNOU(preNode) && preNode.nodeName !== 'BR' &&\n                        !this.parent.domNode.isBlockNode(preNode)) {\n                        tempElem.firstChild.parentElement.insertBefore(preNode, tempElem.firstChild);\n                        preNode = tempElem.previousSibling;\n                    }\n                    if (!isNOU(preNode) && preNode.nodeName === 'BR') {\n                        detach(preNode);\n                    }\n                    var postNode = tempElem.nextSibling;\n                    while (!isNOU(postNode) && postNode.nodeName !== 'BR' &&\n                        !this.parent.domNode.isBlockNode(postNode)) {\n                        tempElem.appendChild(postNode);\n                        postNode = tempElem.nextSibling;\n                    }\n                    if (!isNOU(postNode) && postNode.nodeName === 'BR') {\n                        detach(postNode);\n                    }\n                }\n            }\n            this.setSelectionBRConfig();\n            listsNodes = this.parent.domNode.blockNodes();\n        }\n        for (var i = 0; i < listsNodes.length; i++) {\n            if (listsNodes[i].tagName === 'TABLE' && !range.collapsed) {\n                listsNodes.splice(i, 1);\n            }\n            if (listsNodes.length > 0 && listsNodes[i].tagName !== 'LI'\n                && 'LI' === listsNodes[i].parentNode.tagName) {\n                listsNodes[i] = listsNodes[i].parentNode;\n            }\n        }\n        this.applyLists(listsNodes, this.currentAction, e.selector, e.item);\n        if (e.callBack) {\n            e.callBack({\n                requestType: this.currentAction,\n                event: e.event,\n                editorMode: 'HTML',\n                range: this.parent.nodeSelection.getRange(this.parent.currentDocument),\n                elements: this.parent.domNode.blockNodes()\n            });\n        }\n    };\n    Lists.prototype.setSelectionBRConfig = function () {\n        var startElem = this.parent.editableElement.querySelector('.' + markerClassName.startSelection);\n        var endElem = this.parent.editableElement.querySelector('.' + markerClassName.endSelection);\n        if (isNOU(endElem)) {\n            this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument, startElem, 0);\n        }\n        else {\n            this.parent.nodeSelection.setSelectionText(this.parent.currentDocument, startElem, endElem, 0, 0);\n        }\n    };\n    Lists.prototype.applyLists = function (elements, type, selector, item) {\n        var isReverse = true;\n        if (this.isRevert(elements, type) && isNOU(item)) {\n            this.revertList(elements);\n            this.removeEmptyListElements();\n        }\n        else {\n            this.checkLists(elements, type, item);\n            for (var i = 0; i < elements.length; i++) {\n                if (!isNOU(item) && !isNOU(item.listStyle)) {\n                    if (item.listStyle === 'listImage') {\n                        setStyleAttribute(elements[i], { 'list-style-image': item.listImage });\n                    }\n                    else {\n                        setStyleAttribute(elements[i], { 'list-style-image': 'none' });\n                        setStyleAttribute(elements[i], { 'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase() });\n                    }\n                }\n                if (elements[i].getAttribute('contenteditable') === 'true'\n                    && elements[i].childNodes.length === 1 && elements[i].childNodes[0].nodeName === 'TABLE') {\n                    var listEle = document.createElement(type);\n                    listEle.innerHTML = '<li><br/></li>';\n                    elements[i].appendChild(listEle);\n                }\n                else if ('LI' !== elements[i].tagName && isNOU(item)) {\n                    isReverse = false;\n                    var elemAtt = elements[i].tagName === 'IMG' ? '' : this.domNode.attributes(elements[i]);\n                    var openTag = '<' + type + '>';\n                    var closeTag = '</' + type + '>';\n                    var newTag = 'li' + elemAtt;\n                    var replaceHTML = (elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ? elements[i].innerHTML :\n                        elements[i].outerHTML);\n                    var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n                    var collectionString = openTag + innerHTML + closeTag;\n                    this.domNode.replaceWith(elements[i], collectionString);\n                }\n                else if (!isNOU(item) && 'LI' !== elements[i].tagName) {\n                    // eslint-disable-next-line\n                    isReverse = false;\n                    var elemAtt = elements[i].tagName === 'IMG' ? '' : this.domNode.attributes(elements[i]);\n                    var openTag = '<' + type + elemAtt + '>';\n                    var closeTag = '</' + type + '>';\n                    var newTag = 'li';\n                    var replaceHTML = (elements[i].tagName.toLowerCase() === CONSTANT.DEFAULT_TAG ? elements[i].innerHTML :\n                        elements[i].outerHTML);\n                    var innerHTML = this.domNode.createTagString(newTag, null, replaceHTML);\n                    var collectionString = openTag + innerHTML + closeTag;\n                    this.domNode.replaceWith(elements[i], collectionString);\n                }\n            }\n        }\n        this.cleanNode();\n        this.parent.editableElement.focus();\n        if (isIDevice()) {\n            setEditFrameFocus(this.parent.editableElement, selector);\n        }\n        this.saveSelection = this.domNode.saveMarker(this.saveSelection);\n        this.saveSelection.restore();\n    };\n    Lists.prototype.removeEmptyListElements = function () {\n        var listElem = this.parent.editableElement.querySelectorAll('ol, ul');\n        for (var i = 0; i < listElem.length; i++) {\n            if (listElem[i].textContent.trim() === '') {\n                detach(listElem[i]);\n            }\n        }\n    };\n    Lists.prototype.isRevert = function (nodes, tagName) {\n        var isRevert = true;\n        for (var i = 0; i < nodes.length; i++) {\n            if (nodes[i].tagName !== 'LI') {\n                return false;\n            }\n            if (nodes[i].parentNode.tagName !== tagName) {\n                isRevert = false;\n            }\n        }\n        return isRevert;\n    };\n    Lists.prototype.checkLists = function (nodes, tagName, item) {\n        var nodesTemp = [];\n        for (var i = 0; i < nodes.length; i++) {\n            var node = nodes[i].parentNode;\n            if (!isNOU(item) && 'LI' === nodes[i].tagName && !isNOU(item.listStyle)) {\n                if (item.listStyle === 'listImage') {\n                    setStyleAttribute(node, { 'list-style-image': item.listImage });\n                }\n                else {\n                    setStyleAttribute(node, { 'list-style-image': 'none' });\n                    setStyleAttribute(node, { 'list-style-type': item.listStyle.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase() });\n                }\n            }\n            if ((nodes[i].tagName === 'LI' && node.tagName !== tagName && nodesTemp.indexOf(node) < 0) ||\n                (nodes[i].tagName === 'LI' && node.tagName === tagName && nodesTemp.indexOf(node) < 0 && item !== null)) {\n                nodesTemp.push(node);\n            }\n        }\n        for (var j = nodesTemp.length - 1; j >= 0; j--) {\n            var h = nodesTemp[j];\n            var replace = '<' + tagName.toLowerCase() + ' '\n                + this.domNode.attributes(h) + '>' + h.innerHTML + '</' + tagName.toLowerCase() + '>';\n            this.domNode.replaceWith(nodesTemp[j], replace);\n        }\n    };\n    Lists.prototype.cleanNode = function () {\n        var liParents = this.parent.editableElement.querySelectorAll('ol + ol, ul + ul');\n        for (var c = 0; c < liParents.length; c++) {\n            var node = liParents[c];\n            if (this.domNode.isList(node.previousElementSibling) &&\n                this.domNode.openTagString(node) === this.domNode.openTagString(node.previousElementSibling)) {\n                var contentNodes = this.domNode.contents(node);\n                for (var f = 0; f < contentNodes.length; f++) {\n                    node.previousElementSibling.appendChild(contentNodes[f]);\n                }\n                node.parentNode.removeChild(node);\n            }\n        }\n    };\n    Lists.prototype.findUnSelected = function (temp, elements) {\n        temp = temp.slice().reverse();\n        if (temp.length > 0) {\n            var rightIndent = [];\n            var indentElements = [];\n            var lastElement = elements[elements.length - 1];\n            var lastElementChild = [];\n            var childElements = [];\n            lastElementChild = (lastElement.childNodes);\n            for (var z = 0; z < lastElementChild.length; z++) {\n                if (lastElementChild[z].tagName === 'OL' || lastElementChild[z].tagName === 'UL') {\n                    var childLI = lastElementChild[z]\n                        .querySelectorAll('li');\n                    if (childLI.length > 0) {\n                        for (var y = 0; y < childLI.length; y++) {\n                            childElements.push(childLI[y]);\n                        }\n                    }\n                }\n            }\n            for (var i = 0; i < childElements.length; i++) {\n                var count = 0;\n                for (var j = 0; j < temp.length; j++) {\n                    if (!childElements[i].contains((temp[j]))) {\n                        count = count + 1;\n                    }\n                }\n                if (count === temp.length) {\n                    indentElements.push(childElements[i]);\n                }\n            }\n            if (indentElements.length > 0) {\n                for (var x = 0; x < indentElements.length; x++) {\n                    if (this.domNode.contents(indentElements[x])[0].nodeName !== 'OL' &&\n                        this.domNode.contents(indentElements[x])[0].nodeName !== 'UL') {\n                        rightIndent.push(indentElements[x]);\n                    }\n                }\n            }\n            if (rightIndent.length > 0) {\n                this.nestedList(rightIndent);\n            }\n        }\n    };\n    Lists.prototype.revertList = function (elements) {\n        var temp = [];\n        for (var i = elements.length - 1; i >= 0; i--) {\n            for (var j = i - 1; j >= 0; j--) {\n                if (elements[j].contains((elements[i])) || elements[j] === elements[i]) {\n                    temp.push(elements[i]);\n                    elements.splice(i, 1);\n                    break;\n                }\n            }\n        }\n        this.findUnSelected(temp, elements);\n        var viewNode = [];\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            if (this.domNode.contents(element)[0].nodeType === 3 && this.domNode.contents(element)[0].textContent.trim().length === 0) {\n                detach(this.domNode.contents(element)[0]);\n            }\n            var parentNode = elements[i].parentNode;\n            var className = element.getAttribute('class');\n            if (temp.length === 0) {\n                var siblingList = elements[i].querySelectorAll('ul, ol');\n                var firstNode = siblingList[0];\n                if (firstNode) {\n                    var child = firstNode\n                        .querySelectorAll('li');\n                    if (child) {\n                        var nestedElement = createElement(firstNode.tagName);\n                        append([nestedElement], firstNode.parentNode);\n                        var nestedElementLI = createElement('li', { styles: 'list-style-type: none;' });\n                        append([nestedElementLI], nestedElement);\n                        append([firstNode], nestedElementLI);\n                    }\n                }\n            }\n            if (element.parentNode.insertBefore(this.closeTag(parentNode.tagName), element),\n                'LI' === parentNode.parentNode.tagName) {\n                element.parentNode.insertBefore(this.closeTag('LI'), element);\n            }\n            else {\n                var classAttr = '';\n                if (className) {\n                    // eslint-disable-next-line\n                    classAttr += ' class=\"' + className + '\"';\n                }\n                if (CONSTANT.DEFAULT_TAG && 0 === element.querySelectorAll(CONSTANT.BLOCK_TAGS.join(', ')).length) {\n                    var wrapperclass = isNullOrUndefined(className) ? ' class=\"e-rte-wrap-inner\"' :\n                        ' class=\"' + className + ' e-rte-wrap-inner\"';\n                    var wrapper = '<' + CONSTANT.DEFAULT_TAG + wrapperclass +\n                        this.domNode.attributes(parentNode) + '></' + CONSTANT.DEFAULT_TAG + '>';\n                    this.domNode.wrapInner(element, this.domNode.parseHTMLFragment(wrapper));\n                }\n                else if (this.domNode.contents(element)[0].nodeType === 3) {\n                    var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.parent.domNode.encode(this.domNode.contents(element)[0].textContent));\n                    this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n                }\n                else if (this.domNode.contents(element)[0].classList.contains(markerClassName.startSelection) ||\n                    this.domNode.contents(element)[0].classList.contains(markerClassName.endSelection)) {\n                    var replace = this.domNode.createTagString(CONSTANT.DEFAULT_TAG, parentNode, this.domNode.contents(element)[0].outerHTML);\n                    this.domNode.replaceWith(this.domNode.contents(element)[0], replace);\n                }\n                else {\n                    var childNode = element.firstChild;\n                    className = childNode.getAttribute('class');\n                    attributes(childNode, this.domNode.rawAttributes(parentNode));\n                    if (className && childNode.getAttribute('class')) {\n                        attributes(childNode, { 'class': className + ' ' + childNode.getAttribute('class') });\n                    }\n                }\n                append([this.openTag('LI')], element);\n                prepend([this.closeTag('LI')], element);\n            }\n            this.domNode.insertAfter(this.openTag(parentNode.tagName), element);\n            if (parentNode.parentNode.tagName === 'LI') {\n                parentNode = parentNode.parentNode.parentNode;\n            }\n            if (viewNode.indexOf(parentNode) < 0) {\n                viewNode.push(parentNode);\n            }\n        }\n        for (var i = 0; i < viewNode.length; i++) {\n            var node = viewNode[i];\n            var nodeInnerHtml = node.innerHTML;\n            var closeTag = /<span class=\"e-rte-list-close-([a-z]*)\"><\\/span>/g;\n            var openTag = /<span class=\"e-rte-list-open-([a-z]*)\"><\\/span>/g;\n            nodeInnerHtml = nodeInnerHtml.replace(closeTag, '</$1>');\n            nodeInnerHtml = nodeInnerHtml.replace(openTag, '<$1 ' + this.domNode.attributes(node) + '>');\n            this.domNode.replaceWith(node, this.domNode.openTagString(node) + nodeInnerHtml.trim() + this.domNode.closeTagString(node));\n        }\n        var emptyUl = this.parent.editableElement.querySelectorAll('ul:empty, ol:empty');\n        for (var i = 0; i < emptyUl.length; i++) {\n            detach(emptyUl[i]);\n        }\n        var emptyLi = this.parent.editableElement.querySelectorAll('li:empty');\n        for (var i = 0; i < emptyLi.length; i++) {\n            detach(emptyLi[i]);\n        }\n    };\n    Lists.prototype.openTag = function (type) {\n        return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-open-' + type.toLowerCase() + '\"></span>');\n    };\n    Lists.prototype.closeTag = function (type) {\n        return this.domNode.parseHTMLFragment('<span class=\"e-rte-list-close-' + type.toLowerCase() + '\"></span>');\n    };\n    return Lists;\n}());\nexport { Lists };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}